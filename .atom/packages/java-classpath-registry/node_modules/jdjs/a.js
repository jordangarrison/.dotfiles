'use strict';

const jdjs = require('./index');
const Promise = require('bluebird');
const fs = require('fs');

const cp = fs.readFileSync('../storytelhomepage/.classpath', { encoding: 'utf8' });

const jars = cp.split(':').filter(entry => entry.match(/\.jar$/));
Promise.all(jars).map(jar => {
  console.log(jar, ': starting');
  return jdjs(jar)
    .then((r) => console.log(jar, ': done', r.length))
    .catch(err => console.error(jar, err));
}, { concurrency: 50 }).then(() => console.log('all done'));

