Ih.prototype.W7=JR(52,function(){return Oe(this,3)});ZB.prototype.W7=JR(51,function(){return Oe(this,5)});Ih.prototype.y5=JR(50,function(){return M(this,3)});ZB.prototype.y5=JR(49,function(){return M(this,5)});Ih.prototype.Z7=JR(48,function(){return Oe(this,2)});ZB.prototype.Z7=JR(47,function(){return Oe(this,4)});Ih.prototype.R5=JR(46,function(){return M(this,2)});ZB.prototype.R5=JR(45,function(){return M(this,4)});function jXc(a,b){var c=im(a,b);return u(c)?String(im(a,b)):null}
function kXc(a,b){Wc(a,11).push(b)}function lXc(a){return(new dI(a.J)).jc("title")}function mXc(a,b){a.D=b}function nXc(a){return null!=a?a:Number.MIN_VALUE}function oXc(a){return null!=a?a:Number.MAX_VALUE}function pXc(a,b){return tqc(b)?tqc(a)&&M(a,1)==M(b,1):tqc(a)?nXc(M(a,1))>nXc(M(b,1))&&nXc(M(a,1))<oXc(vf(b)):nXc(M(a,1))>=nXc(M(b,1))&&oXc(vf(a))<=oXc(vf(b))}var qXc=/['()]/g;function rXc(a){return"%"+a.charCodeAt(0).toString(16)}
function sXc(a){a=Ta(String(a));qXc.lastIndex=0;return qXc.test(a)?a.replace(qXc,rXc):a}function tXc(a){var b=new Jf;b.setType(0);var c=new tf,d=new rf;N(d,1,2);a=Sa(a);N(d,2,a);c.fb(d);d=new Ye;d.setType(0);N(c,1,d);N(b,5,c);return b}function uXc(a){return a.Pl()+fb(a.C)}function vXc(a){return U("<li class='nfd-format-pill'><div class='nfd-format-display'>"+T(a.Udb)+"</div><div class='nfd-format-sample'>"+T(a.tQb)+"</div></li>")};function wXc(a,b,c){R.call(this);this.Bd(a);this.D=b;this.C=c}y(wXc,R);p=wXc.prototype;p.Ha=function(){var a=this.hb(),b=this.C?Oaa(VR(a),30):VR(a);a=this.C?t6b(a,this.D):"";this.La=S(vXc,{Udb:b,tQb:a})};p.Ra=function(){wXc.qa.Ra.call(this);io(this.getElement(),!0);var a=new Ks(this.getElement());this.Ba(a);this.getHandler().V(a,"key",this.m0b).V(this.getElement(),"mousedown",this.l0b).V(this.getElement(),"dblclick",this.Qob)};
p.m0b=function(a){function b(a,b){for(;b=a(b);)if(rr(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(ao,this.getElement());break;case 38:b(gva,this.getElement())}};p.l0b=function(a){a.preventDefault();this.dispatchEvent("change")};p.Qob=function(){this.dispatchEvent("action")};function xXc(a,b,c){R.call(this);this.D=b;this.C=c;yXc(this,a)}y(xXc,R);xXc.prototype.Ha=function(){this.La=this.Aa().Ha("UL","nfd-pill-container")};function yXc(a,b){A(b,function(b){a.Qa(new wXc(b,a.D,a.C),!0)})}xXc.prototype.filter=function(a){a=a.toLowerCase();this.Ef(function(b){var c=Qa(fb(a)),d=VR(b.hb()).toLowerCase();c=c||$a(d,a);Q(b.getElement(),c)})};function j_(a){ss.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Lfa();this.Qa(this.input,!0);this.J=new R;this.Qa(this.J,!0);a=this.Y5();Mb(a,void 0,uXc);this.C=new xXc(a,this.OX(),this.PSa());this.J.Qa(this.C,!0);Es(this,null);this.pj=!0}y(j_,ss);p=j_.prototype;p.CVa=Qh;p.PSa=Ph;p.isEmpty=function(){return Qa(this.input.$a())};p.uf=function(){return this.input.hb().uf()};p.Ha=function(){j_.qa.Ha.call(this);var a=En("DIV","dialog-separator");Wn(a,ws(this))};
p.Ra=function(){j_.qa.Ra.call(this);Zr(this.J.getElement(),"nfd-dialog-content");this.getHandler().V(this.C,"change",this.$qb).V(this.C,"action",this.esa).V(this.input.O,"action",this.esa).V(this.input,"afterhide",this.xjb);this.input.R&&this.getHandler().V(this.input.R,"input",this.e0b);var a=this.input.Fa;a&&this.getHandler().V(a,"key",this.f0b);a=this.Y5()[0];this.input.tM(a)};p.xjb=function(a){a.stopPropagation()};p.$qb=function(a){this.input.tM(a.target.hb());zXc(this.input,!1)};
p.e0b=function(){this.C.filter(this.input.$a());zXc(this.input,!this.input.hb().uf())};p.f0b=function(a){13==a.keyCode&&this.esa()};p.esa=function(){this.uf()&&!this.isEmpty()?(qNa.mc(new UR(this.p1(),void 0,this.CVa())),this.setVisible(!1)):(zXc(this.input,!0),this.input.oEa())};function k_(a,b,c,d,e){it.call(this,b,c,d,e);this.C=a}y(k_,it);k_.prototype.Lk=function(){var a=k_.qa.Lk.call(this),b=this.getParent();return b&&b instanceof ev&&!b.isVisible()?this.C(a,this.hb()):a};function l_(a){R.call(this);this.J=new R;this.Ba(this.J);this.D=new vS("");this.Ba(this.D);this.O=new Yu("");this.Ba(this.O);this.$=a;this.Fa=null}y(l_,R);p=l_.prototype;
p.Ra=function(){l_.qa.Ra.call(this);var a=Cr(this,"nfd-icwr");this.J.kb(a);this.Qa(this.J);if(a=Cr(this,"nfd-i"))this.D.kb(a),this.D.zd(this.J),as(this.D.getElement(),"jfk-textinput"),a=new st,a.kb(this.D.getElement()),this.Ba(a),this.R=a=new rt(this.D.getElement()),this.Ba(a),this.Fa=a=new Ks(this.D.getElement()),this.Ba(a),a=new fs(this.D.getElement()),this.getHandler().V(a,"focusout",Fa(this.AVa,!1)).V(a,"focusin",Fa(this.AVa,!0)).V(this.R,"input",this.d0b);a=Cr(this,"nfd-a");this.O.kb(a);this.Qa(this.O)};
p.$a=function(){return this.D.$a()};p.d0b=function(){var a=this.hb(),b=this.$a();N(a.kH,2,b);this.BVa()};p.BVa=Qh;p.AVa=function(a){cs(this.J.getElement(),"nfd-input-focus",a)};p.tM=function(a){this.Bd(a.clone());this.D.fb(VR(a));try{this.D.getElement().focus()}catch(b){}};p.oEa=function(){this.D.getElement().focus()};function zXc(a,b){a=a.J.getElement();cs(a,"nfd-invalid",b)};function AXc(a){var b;a=a||{};return U('<input class="'+W("jfk-textinput")+(a.xd?" "+W(a.xd):"")+'"'+(a.id?' id="'+W(a.id)+'"':"")+(a.maxLength?' maxlength="'+W(a.maxLength)+'"':"")+(a.k$&&a.EVb?' label="'+W(a.k$)+'"':"")+(a.name?' name="'+W(a.name)+'"':"")+(a.k$?' placeholder="'+W(a.k$)+'"':"")+' type="'+W(null==(b=a.type)?"text":b)+'"'+(a.pattern?' pattern="'+W(a.pattern)+'"':"")+(a.value?' value="'+W(a.value)+'"':"")+(a.dir?' dir="'+W(a.dir)+'"':"")+(a.attributes?" "+Nt(a.attributes):"")+">")}
;function BXc(a){return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.xZ)+"'>"+CXc(a)+"</div>"+DXc(a)+"</div>")}function EXc(a){return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.xZ)+"'></div>"+DXc(a)+"</div>")}
function FXc(a){return U("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.xZ)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+CXc(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+W(a.sGb)+"'></div></div></div></div>"+DXc(a)+"</div>")}
function GXc(){var a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+HXc({label:""})+HXc({label:Jt("Negative:")})+HXc({label:Jt("Zero:")})+HXc({label:Jt("Text:")})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>");return U(a)}function HXc(a){return U("<tr><td class='nfd-sample-label'>"+T(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function DXc(a){a=""+T(Ou({id:a.GV,style:2,xd:"nfd-apply",content:It("Apply")}));return U(a)}function CXc(a){return U(T(AXc({id:a.WLa,k$:a.XLa,EVb:!0})))};function IXc(a){l_.call(this,a);this.F=new R;this.C=new BM("")}y(IXc,l_);p=IXc.prototype;p.Ha=function(){this.La=S(FXc,{xZ:Ar(this,"nfd-icwr"),WLa:Ar(this,"nfd-i"),XLa:this.$,sGb:Ar(this,"nfd-ic"),GV:Ar(this,"nfd-a")})};p.Ra=function(){IXc.qa.Ra.call(this);var a=Cr(this,"nfd-ic");this.F.kb(a);this.F.zd(this.J);this.F.Qa(this.C,!0);this.getHandler().V(this.C,"aftershow",this.g0b).V(this.C,"action",this.$Ia).V(this.R,"input",Fa(this.EUa,null))};
p.tM=function(a){IXc.qa.tM.call(this,a);a.C&&this.D.fb(dp[a.C][1]);this.EUa(a)};
p.EUa=function(a){a=a?a.C:void 0;var b=this.C;b.Mf(null);if(a){var c=this.hb(),d=c.C;JXc(this,c);c=wic(d,dp[d][2]);c=new UR(KXc(c),uic[d],d);JXc(this,c);c=wic(d,d+" "+dp[d][1]);d=new UR(KXc(c),uic[d],d);JXc(this,d)}else this.hb().C=null;var e="[$"+this.$a()+"]";d=a?uic[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new UR(KXc(c[e]),d,a);JXc(this,f)}b.Bf(0);this.$Ia();Zr(b.wc().getElement(),"number-format-menu")};function JXc(a,b){var c=new k_(function(a){return Oaa(a,25)},t6b(b,1E3),b);a.Ba(c);a.Ba(b);c.Jp(!0);a=a.C;for(b=0;b<a.mj();b++)if(a.Te(b).Lk()==c.Lk())return;a.Fd(c)}p.$Ia=function(){for(var a=this.C,b=0;b<a.mj();b++)a.Te(b).yc(!1);a.YH()};p.g0b=function(){this.C.jf().yc(!0)};function KXc(a){var b=new Ye;N(b,2,a);b.setType(4);return b};function LXc(a){j_.call(this,a);ts(this,"Custom currencies")}y(LXc,j_);p=LXc.prototype;p.OX=n(1000.12);p.Lfa=function(){return new IXc("Custom currency")};p.Y5=function(){var a=this;G7b();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=uic[e]:mXc(d,yic(d.Pl()))}var f=[];Zb(dp,function(b,c){b=xic(c);a.Ba(b);f.push(b)});var h=jyc();Pb(f,function(a,b){return h(VR(a),VR(b))});return b.concat(f)};
p.p1=function(){var a=new Ye;a.setType(4);N(a,3,1);var b=this.input.C.jf().$a().Pl();N(a,2,b);return a};p.CVa=function(){return this.input.hb().C};function MXc(a){R.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}y(MXc,R);MXc.prototype.Ha=function(){var a=S(GXc);this.F=zn("nfd-sample-label",a);this.D=Xua("nfd-rendered-sample",a);this.La=a};function m_(a,b){l_.call(this,a);this.C=new MXc(b);this.Bd(new UR(""))}y(m_,l_);m_.prototype.Ha=function(){this.La=S(BXc,{WLa:Ar(this,"nfd-i"),XLa:this.$,xZ:Ar(this,"nfd-icwr"),GV:Ar(this,"nfd-a")})};m_.prototype.Ra=function(){m_.qa.Ra.call(this);this.Qa(this.C,!0);NXc(this)};m_.prototype.BVa=function(){NXc(this)};m_.prototype.tM=function(a){m_.qa.tM.call(this,a);NXc(this)};
function NXc(a){var b=a.hb();if(b){var c=a.C;a=b.Pl().split(";").length-1;go(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=t6b(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Pl()),k=d<=a;Q(co(e),k);go(e,f);Xq(e,"color",h||"")}d=b.uf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Pl()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Pl());c=c.D[3];Q(co(c),3<=a);go(c,d);Xq(c,"color",b||"")}};function OXc(a){j_.call(this,a);ts(this,"Custom number formats")}y(OXc,j_);OXc.prototype.OX=n(1234.56);OXc.prototype.Lfa=function(){return new m_("Custom number format",1234.56)};
OXc.prototype.Y5=function(){var a=this.F;a.push(new UR("0"));a.push(new UR("0.00"));a.push(new UR("#,##0"));a.push(new UR("#,##0.00"));a.push(new UR("#,##0_);(#,##0)"));a.push(new UR("#,##0_);[Red](#,##0)"));a.push(new UR("#,##0.00_);(#,##0.00)"));a.push(new UR("#,##0.00_);[Red](#,##0.00)"));a.push(new UR("$#,##0_);($#,##0)"));a.push(new UR("$#,##0_);[Red]($#,##0)"));a.push(new UR("$#,##0.00_);($#,##0.00)"));a.push(new UR("$#,##0.00_);[Red]($#,##0.00)"));a.push(new UR("@"));a.push(new UR("0%"));a.push(new UR("0.00%"));
a.push(new UR("0.00E+00"));a.push(new UR("##0.0E+0"));a.push(new UR("# ?/?"));a.push(new UR("# ??/??"));a.push(new UR('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new UR('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new UR('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new UR('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};OXc.prototype.p1=function(){var a=new Ye;a.setType(2);N(a,3,1);var b=this.input.$a();N(a,2,b);return a};function n_(a,b){pv.call(this,b,new PXc(a))}y(n_,pv);p=n_.prototype;p.wh=function(a,b,c){n_.qa.wh.call(this,a,b,c);a.Wb()&&this.Wb()&&a.getParent()==this&&QXc(this)};p.Ra=function(){n_.qa.Ra.call(this);QXc(this)};p.hd=function(a){n_.qa.hd.call(this,a);QXc(this)};p.removeChild=function(a,b){a=n_.qa.removeChild.call(this,a,b);QXc(this);return a};p.Hn=function(a,b){a=n_.qa.Hn.call(this,a,b);QXc(this);return a};
p.Jj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=hv(this);if(c){b=39==b;this.Af()&&(b=!b);c=c.getElement();c=ob(c.parentNode.childNodes,c);var d=(d=(d=hv(this))?vva(d.getElement(),RXc):null)?ob(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=SXc(this,e);b?b=SXc(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.haa(this.Uj+b);b=!0}else b=!1}b=!b}return b?n_.qa.Jj.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function SXc(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function QXc(a){var b,c=a.Hd(),d=a.Vc(),e=Jb(yn("div",RXc,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.Aa().Ha("DIV",RXc),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.Vc();k++)a.ad(k)instanceof ov?(d.push(new TXc(b,k,!0)),b=k+1):a.ad(k)instanceof kv&&(0==k?h=!0:(a.ad(k-1),d.push(new TXc(b,k-1,!1)),b=k));k=a.Vc();0<d.length&&nb(d).end!=k-1&&d.push(new TXc(b,k-1,!1));b=h;h=a.Vc();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.Vc()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else UXc(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.Vc();f++){for(;f>c[d];)++d;b=a.ad(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof ov?Q(h,!1):Q(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function UXc(a,b,c){function d(a){return a.end-a.start-(a.jFb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;Eb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,Eb(a,l,1))}}function TXc(a,b,c){this.start=a;this.end=b;this.jFb=c}function PXc(a){nv.call(this);this.D=a}y(PXc,nv);var RXc="docs-multi-menu-col";function VXc(a){this.C=a}y(VXc,G);VXc.prototype.create=function(){return new n_(this.C)};function WXc(a,b){l_.call(this,a);this.va=new R;this.H=new XXc;this.F=new R;a=(new VXc(3)).create();a.Qa(new kv("Date"),!0);a.Qa(new it("Day","DAY_TOKEN"),!0);a.Qa(new it("Month","MONTH_TOKEN"),!0);a.Qa(new it("Year","YEAR_TOKEN"),!0);a.Qa(new kv("Time"),!0);a.Qa(new it("Hours","HOURS_TOKEN"),!0);a.Qa(new it("Minutes","MINUTES_TOKEN"),!0);a.Qa(new it("Seconds","SECONDS_TOKEN"),!0);a.Qa(new it("Milliseconds","MILLIS_TOKEN"),!0);a.Qa(new it("AM/PM","AM_PM_TOKEN"),!0);a.Qa(new kv("Duration"),!0);a.Qa(new it("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Qa(new it("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Qa(new it("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new jrb(a);this.C=b}y(WXc,l_);p=WXc.prototype;p.Ha=function(){this.La=S(EXc,{xZ:Ar(this,"nfd-icwr"),GV:Ar(this,"nfd-a")})};
p.Ra=function(){WXc.qa.Ra.call(this);Zr(this.getElement(),"nfd-date-time-input");var a=Cr(this,"nfd-icwr"),b=this.va;b.kb(a);b.zd(this);b.Qa(this.L,!0);Zr(this.L.getElement(),"nfd-date-time-menu-button");Zr(this.L.wc().getElement(),"nfd-date-time-menu");Wr(this.L.La,"Add a date or time format");b.Qa(this.H,!0);Bc||Zr(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Qa(a,!0);Xq(a.getElement(),"display","inline");this.getHandler().V(this,"ee",Fa(this.DVa,"left")).V(this,"ie",Fa(this.XJa,"left")).V(this,
"je",Fa(this.XJa,"right")).V(this,"ke",Fa(this.FKa,"left")).V(this,"le",Fa(this.FKa,"right")).V(this,"he",Fa(this.DVa,"right")).V(this.L,"action",this.Jnb)};p.oEa=function(){this.va.getElement().focus()};
p.tM=function(a){this.Bd(a.clone());var b=this.F;b.Dd(!0);go(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Pl());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?go(this.H.getElement(),d[2]):(e=b.ad(b.Vc()-1),d=d[2],go(e.eA.getElement(),ko(e.eA.getElement())+d)):YXc(this,e).fb(d[1])}0<b.Vc()&&b.ad(b.Vc()-1).jy.getElement().focus()};
p.$a=function(){for(var a=this.H.toString(),b=0;b<this.F.Vc();b++)a+=this.F.ad(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=bb(e,"["),e=bb(e,"]")):c=!0}b+=e}return b};p.Jnb=function(a){a=a.target.$a();YXc(this,a).jy.getElement().focus()};
function YXc(a,b){zXc(a,!1);switch(b){case "DAY_TOKEN":var c=ZXc(a);break;case "MONTH_TOKEN":c=$Xc(a);break;case "YEAR_TOKEN":c=aYc(a);break;case "HOURS_TOKEN":c=bYc();break;case "MINUTES_TOKEN":c=cYc();break;case "SECONDS_TOKEN":c=dYc();break;case "MILLIS_TOKEN":c=eYc();break;case "AM_PM_TOKEN":c=fYc(a);break;case "ELAPSED_HOURS_TOKEN":c=gYc();break;case "ELAPSED_MINUTES_TOKEN":c=hYc();break;case "ELAPSED_SECONDS_TOKEN":c=iYc()}b=c;b.Qa(new ov,!0);b.Qa(new it("Delete"),!0);c=new jYc(c,"");a.F.Qa(c,
!0);return c}p.DVa=function(a,b){b=b.target;if(b instanceof XXc){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.ad(Dr(this.F,b)+1),!b))return}a=ko(b.eA.getElement());var c=b.getParent(),d=Dr(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=ko(b),go(b,c+a),kYc(this.H,c.length)):(d--,b=c.ad(d),c=ko(b.eA.getElement()),go(b.eA.getElement(),ko(b.eA.getElement())+a),kYc(b.eA,c.length))};
p.FKa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.ad(Dr(this.F,b)+a))&&a.jy.getElement().focus()};p.XJa=function(a,b){var c="left"==a?-1:0;(b=this.F.ad(Dr(this.F,b.target)+c))||"left"!=a?b&&(b=b.eA):b=this.H;c=ko(b.getElement()).length;kYc(b,"left"==a?c:0)};function jYc(a,b){R.call(this);this.jy=new BM("",a);this.Qa(this.jy,!0);this.eA=new XXc(b);this.Qa(this.eA,!0)}y(jYc,R);p=jYc.prototype;
p.Ra=function(){jYc.qa.Ra.call(this);Xq(this.getElement(),"display","inline-block");this.jy.Bf(0);this.C=new Ks(this.jy.getElement());this.Ba(this.C);this.getHandler().V(this.jy,"action",this.h0b).V(this.C,"key",this.i0b)};p.h0b=function(){this.jy.YH();this.jy.jf().hb()||this.dispatchEvent("he")};p.i0b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("he"));break;case 37:a.preventDefault();this.dispatchEvent("ie");break;case 39:a.preventDefault(),this.dispatchEvent("je")}};
p.toString=function(){return this.jy.jf().hb()+this.eA.toString()};p.fb=function(a){this.jy.fb(a)};function XXc(a){R.call(this);this.C=a||""}y(XXc,R);p=XXc.prototype;p.Ha=function(){var a=En("SPAN");An(a,{contentEditable:!0});go(a,this.C);var b=a.style;yc&&!Hc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Bc?"-moz-pre-wrap":"pre-wrap";this.La=a};
p.Ra=function(){XXc.qa.Ra.call(this);var a=new Ks(this.getElement());this.Ba(a);this.getHandler().V(a,"key",this.j0b).V(this.getElement(),"paste",this.k0b)};function kYc(a,b){if(0==ko(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=uO(c,b);a.getElement().focus();b.select()}}
p.j0b=function(a){var b=jo(this.getElement()),c=kO(),d=ko(this.getElement()).length,e=c?0==c.Mh()&&0==c.Tn():Qa(fb(b));b=c?c.Mh()==d&&c.Tn()==d:Qa(fb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("ee"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("he"));break;case 40:this.dispatchEvent("fe");break;case 38:this.dispatchEvent("ge");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("ke"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("le"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=xaa(ko(this.getElement())).replace(/"/g,'"\\""');return 0==fb(a).length?"":'"'+a+'"'};p.k0b=function(){var a=v(function(){go(this.getElement(),ko(this.getElement()))},this);gi(a)};
function ZXc(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new k_(Fa(b,e),a,d));d=new pv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function $Xc(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new k_(Fa(b,e),a,d));d=new pv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function aYc(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new k_(Fa(b,e),a,d));d=new pv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function bYc(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c=new pv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function cYc(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c=new pv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function dYc(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c=new pv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function eYc(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new k_(Fa(a,d),e,c));c=new pv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function fYc(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new k_(Fa(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new k_(Fa(b,e),a,d));d=new pv;for(e=0;e<c.length;e++)d.Qa(c[e],!0);return d}
function gYc(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c=new pv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function hYc(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c=new pv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c}
function iYc(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new k_(Fa(a,d),e,c));c=new pv;for(d=0;d<b.length;d++)c.Qa(b[d],!0);return c};function lYc(a){j_.call(this,a);ts(this,"Custom date and time formats")}y(lYc,j_);p=lYc.prototype;p.PSa=Oh;p.OX=n(11175.5628472222);p.isEmpty=function(){return Qa(Ve(this.p1(),2))};p.uf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Ve(this.p1(),2))};p.Lfa=function(){return new WXc("Custom date time format",11175.5628472222)};p.p1=function(){return mYc(this.input.$a())};
p.Y5=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.OX(),c.Pl());c.D=d}b=nYc(this);Mb(b);for(c=0;c<b.length;c++)a.push(new UR(mYc(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.OX(),b[c])));return a};
function nYc(a){var b=Zw,c=rb(b.DATEFORMATS,function(a){return oYc(a)},a),d=rb(b.TIMEFORMATS,function(a){return oYc(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;Mb(b);a=rb(b,function(a){return oYc(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function oYc(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Sa(a.join(""))}function mYc(a){var b=new Ye;b.setType(7);N(b,3,1);N(b,2,a);return b};function pYc(a,b){this.D=a;this.C=b}pYc.prototype.getUrl=g("D");function qYc(a,b,c,d,e,f){iw.call(this,a,b,"domain",d,e,f);this.H=c}y(qYc,iw);qYc.prototype.C=function(){var a=qYc.qa.C.call(this);a.domainName=this.H;return $b(a,VJa)};lKa.set("domain",function(a){return new qYc(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new qYc("","DEFAULT","",!0);function rYc(){};function sYc(a){for(var b="",c=a.MRb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.KRb[f.Nh()];f.getName();var k=f.getLabel();f=f.$Fb;f=U('<div id="'+W(h)+'" tabindex="0" role="link" class="'+W("ess-button")+'" aria-label="'+W(k)+'"><div class="'+W("ess-icon")+" "+W(f)+'"></div></div>');b+=f}return U(b+"")};function tYc(a,b){R.call(this,b);this.C=a||[];this.F=[];this.D=null}y(tYc,R);p=tYc.prototype;p.Aea=!0;p.Yda=!1;p.lP=null;p.HCa=!1;p.eb=function(a,b){this.Aea=a;this.Yda=b;if(this.HCa){b=this.Aa();for(var c=0,d;d=this.C[c];c++){var e=b.getElement(this.lP.Apa+"-"+d.Nh()),f=a;cs(e,"ess-button",f);cs(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();Nu(e,f,d)}}};
p.Ha=function(){this.La=this.ob.createElement("SPAN");var a={};a.Apa=Ar(this,"service");a.MRb=this.C;this.lP=a;for(var b={},c=0,d;d=this.C[c];c++)b[d.Nh()]=this.lP.Apa+"-"+d.Nh();a.KRb=b;this.lP=a;xt(this.getElement(),sYc,this.lP);this.HCa=!0};
p.CPb=function(a){if(this.Aea){if(this.D){var b={};b.externalSharingService=a.C;this.D.C(9,b)}if(this.Yda)this.dispatchEvent(new uYc(new vYc));else{var c=this.D||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={LEc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Er(b,a))&&a.focus()}}};
p.Ra=function(){this.eb(this.Aea,this.Yda);for(var a=this.Aa(),b=this.getHandler(),c=0,d;d=this.C[c];c++){var e=a.getElement(this.lP.Apa+"-"+d.Nh());b.Zg(e,Je,v(this.CPb,this,d))}};p.Oa=function(){tYc.qa.Oa.call(this);delete this.F;delete this.C;this.D=null};function uYc(a,b){I.call(this,"me",b);this.context=a}y(uYc,I);function vYc(){}y(vYc,rYc);function o_(a,b,c,d){this.C=a;this.F=b;this.D=c;this.$Fb=d;this.H=wYc++}var wYc=0;o_.prototype.Nh=g("H");o_.prototype.getName=g("F");o_.prototype.getLabel=g("D");function xYc(){o_.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}y(xYc,o_);xYc.prototype.getUrl=function(a){var b=rb(a,function(a){return a.C});a=rb(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Ta(a.join(","))+"&t="+Ta(b.join(","))};function yYc(){o_.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}y(yYc,o_);yYc.prototype.getUrl=function(a){a=rb(a,function(a){return a.C+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Ta(a.join("\n"))};function zYc(){o_.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}y(zYc,o_);zYc.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Ta(a[0].getUrl())};function AYc(){o_.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}y(AYc,o_);AYc.prototype.getUrl=function(a){for(var b=pa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].C;h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Ta(a)};function p_(a){R.call(this,a)}y(p_,R);function BYc(a){a.dispatchEvent(new I("ne"))}p_.prototype.RX=function(){return{}};p_.prototype.mK=Qh;p_.prototype.rpa=ta;function CYc(a){R.call(this,a)}y(CYc,R);CYc.prototype.F=Qh;CYc.prototype.H=ta;CYc.prototype.J=ta;function DYc(a){var b="",c="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+sXc(a.locale)+'&answer=183965">Learn more</a>');b+='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+c+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
W(a.c9a)+'" readonly="readonly" aria-label="'+Mt("Link to published document.")+" "+W(a.iQa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
Mt("HTML embed code of published document.")+" "+W(a.iQa)+'">'+zGa(a.Tcb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+T(Ou({id:"pub-dialog-publish-link-button",style:2,value:a.BPb}))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+T(lw({Fw:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"}))+'Published content & settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
T(Ou({id:"pub-dialog-publish-button",value:a.zPb}))+'<div class="pub-dialog-checkbox-container">';a.EGb&&(c="Require viewers to sign in with their "+(T(a.domain)+" account"),b+=T(St({id:"pub-dialog-dom-signin-req",checked:a.bt,disabled:a.KJ}))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.KJ?' class="pub-dialog-disabled-text"':"")+">"+c+"</label><br>");a.tP&&(b+=T(St({id:"pub-dialog-auto-publish-checkbox"}))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return U(b+"</div></div></div></div></div>")};function q_(a,b,c,d,e,f,h,k,l,m){Vt.call(this);this.Ab=a||"";this.Pe=b;this.kd=c;this.Zc=d;this.Lc=l||"/publishsettings";this.C=new EYc(e);this.Kb=new tYc([new zYc,new yYc,new xYc,new AYc]);this.Qa(this.Kb);this.Fa=new Yu(null,this.Aa());this.Qa(this.Fa);this.R=new Yu(null,this.Aa());this.Qa(this.R);this.gb=new Tt(void 0,this.Aa());this.Qa(this.gb);this.Ia=new Tt(void 0,this.Aa());this.Qa(this.Ia);this.ib=0;this.Ub=new FYc;this.Qa(this.Ub);this.Db=this.Lb=null;this.J=f||new p_;this.Qa(this.J);this.F=
h||new p_;this.Qa(this.F);this.cb=k||new CYc;this.Qa(this.cb);this.O=this.L=null;this.wb=new fw(void 0,GYc,this.Aa(),2);this.Ba(this.wb);this.Le=this.ud=null;this.qf=m||new R;this.Yb=this.jb=this.Nb=null;this.pj=!0}y(q_,Vt);var GYc="Press "+((Ec?"\u2318+C":"Ctrl+C")+" to copy.");p=q_.prototype;p.show=function(){HYc(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){q_.qa.setVisible.call(this,a);var b=ro(this.Aa());a?this.getHandler().V(b,"resize",this.ld):this.getHandler().Gc(b,"resize",this.ld)};
p.Ha=function(){q_.qa.Ha.call(this);var a=this.Aa(),b=S(DYc,{EGb:!!this.C.domain,tP:this.C.tP(),bt:this.C.bt,domain:this.C.C,KJ:this.C.KJ,zPb:IYc(this),BPb:r_(this,JYc(this))?"Published":"Publish",c9a:this.C.Qk?KYc(this,this.J.RX()):"",Tcb:this.C.Qk?LYc(this,this.F.RX()):"",locale:"en",iQa:GYc});a.appendChild(this.Pb(),b);ts(this,"Publish to the web");Es(this,null);Zr(this.Pb(),"pub-dialog-content")};
p.Ra=function(){var a=this.Aa(),b=a.getElement("pub-dialog-sharing-services-links");this.Kb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Nb=a.getElement("pub-dialog-links-notice");this.qf.render(this.Nb);b=a.getElement("pub-dialog-published-content");this.cb.render(b);q_.qa.Ra.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.gb.kb(c),Bt(this.gb,a.getElement("pub-dialog-dom-signin-req-label")),
b.V(this.gb,"change",this.QUb));this.C.tP()&&(this.Ia.kb(a.getElement("pub-dialog-auto-publish-checkbox")),Bt(this.Ia,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.V(this.Ia,"change",this.MUb));this.Lb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Db=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");dw(this.wb,this.L);this.Ub.kb(a.getElement("pub-dialog-links-tab-bar"));this.ud=a.getElement("pub-dialog-sharing-services");
this.Le=a.getElement("pub-dialog-status-info");this.Fa.kb(a.getElement("pub-dialog-publish-link-button"));this.R.kb(a.getElement("pub-dialog-publish-button"));this.Yb=new RO("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Qk);this.Ba(this.Yb);b.V(this.Ub,"select",this.xAb).V(this.L,"focus",this.FRa).V(this.O,"focus",this.FRa).V(this.R,"action",this.DPb).V(this.getElement(),"keyup",this.m8a).V(this.J,"ne",this.pra).V(this.F,"ne",this.pra).V(this.Fa,"action",this.Dyb).V(this.cb,"oe",
this.Eyb).V(this.Yb,"toggle",this.ld);MYc(this)};function MYc(a){if(a.Wb()){var b=a.Aa(),c=a.C.Qk,d=a.C.KJ;a.cb.H(a.C.Vm);a.gb.eb(!d);a.R.setContent(IYc(a));a.R.eb(a.C.Qk||!a.C.Vm||!a.C.Vm.isEmpty());a.C.tP()&&a.Ia.yc(a.C.yw);a.pra();b=b.Oi("pub-dialog-state-publishing");A(b,function(a){Q(a,c)});go(a.Le,c?"This document is published to the web.":"This document is not published to the web.");a.ld()}}p.m8a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function NYc(a,b){var c=window.location.href,d=vj(c);c=zj(c);var e=$a(c,"/"+a.Zc+"/")?"/"+a.Zc:"";a.C.bt&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.Ab;b=Tta.test(b)?b:Oj("/d/"+a,b);return uj(c,f,h,d,Oj(e,b))}
p.pra=function(){var a=this.J.mK();if(a=r_(this,a)){var b=this.J.RX();b=this.C.Qk?KYc(this,b):"";this.L.value=b;this.Kb.F=[new pYc(b,this.Pe)]}Q(this.L,a);Q(this.ud,a&&!this.C.KJ);a=this.F.mK();if(a=r_(this,a))b=this.F.RX(),this.O.value=this.C.Qk?LYc(this,b):"";Q(this.O,a);a=r_(this,JYc(this));Q(this.Nb,a);this.Fa.eb(!a);this.Fa.setContent(r_(this,JYc(this))?"Published":"Publish")};
p.xAb=function(a){a=a.target;this.Aa();ew(this.wb);"pub-dialog-link-tab"==a.getId()?(this.ib=0,Q(this.Lb,!0),Q(this.Db,!1),dw(this.wb,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.ib=1,Q(this.Lb,!1),Q(this.Db,!0),dw(this.wb,this.O));MYc(this)};p.FRa=function(a){gi(function(){a.target.select()},0)};p.QUb=function(){this.C.Qk?OYc(this,2,!1):this.C.bt=!this.C.bt};p.MUb=function(){this.C.Qk?OYc(this,0,!1):this.C.yw=!this.C.yw};function IYc(a){return a.C.Qk?"Stop publishing":"Start publishing"}
function HYc(a,b){qm(a.kd.Oe(a.Lc).Df("id",a.Ab),v(function(a){this.C.Qk=!!im(a,"published");this.C.bt=!!im(a,"requireSignin");this.C.KJ=!!im(a,"domainClosed");this.C.domain=jXc(a,"domain");this.C.C=jXc(a,"domainDisplay");var c=this.C;var e=Number(im(a,"revision"));c.yw=!e;this.C.Vm=this.UFa(a.Ye());this.C.F=jXc(a,"publishedDocumentId");b()},a)).ze()}p.UFa=Qh;p.AFa=Qh;function PYc(a){return{yw:a.C.yw,Qk:a.C.Qk,bt:a.C.bt,Vm:a.C.Vm}}
function OYc(a,b,c){c=u(c)?c:!0;var d=PYc(a);switch(b){case 0:d.yw=!d.yw;break;case 1:d.Qk=!d.Qk;break;case 2:d.bt=!d.bt;break;default:throw Error("Unknown toggle op: "+b);}d.Qk||(d.Vm=a.AFa());QYc(a,d,c)}
function QYc(a,b,c){RYc(a,!1);pm(qm(nm(rm(a.kd.Oe(a.Lc).Df("id",a.Ab),SYc(a,b)),2),v(function(){this.C.yw=b.yw;this.C.Qk=b.Qk;this.C.bt=b.bt;this.C.Vm=b.Vm;this.C.Qk&&this.C.Vm&&(r_(this,this.J.mK())||this.J.rpa(this.C.Vm),r_(this,this.F.mK())||this.F.rpa(this.C.Vm));RYc(this,!0);MYc(this);if(c&&this.C.Qk)switch(this.ib){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.ib);}},a)),v(function(){cHa("An error occurred while saving publishing settings.",
void 0,this.Wb()?this:void 0);RYc(this,!0);MYc(this)},a)).ze()}function SYc(a,b){var c={id:a.Ab,requireSignin:b.bt,published:b.Qk};a.C.tP()&&!b.yw&&(c.revision=a.C.D);b.Vm&&(a=TYc(b.Vm),sc(c,a));return c}function RYc(a,b){for(var c=[a.Ia,a.R,a.Fa,a.gb],d=0;d<c.length;d++){var e=c[d];!b&&e.Yo()&&(a.jb=e);e.eb(b)}b&&a.jb&&(a.isVisible()&&a.jb.isVisible()&&(c=a.jb.getElement())&&c.focus(),a.jb=null);a.cb.J(b)}
p.DPb=function(a,b){if(b||window.confirm(this.C.Qk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.R.setContent("Saving..."),OYc(this,1)};function JYc(a){switch(a.ib){case 0:return a.J.mK();case 1:return a.F.mK();default:throw Error("Cannot handle selected link type "+a.ib);}}
p.Dyb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=JYc(this),b=PYc(this);b.Qk=!0;a&&(b.Vm&&this.C.Qk?b.Vm=UYc(b.Vm,a):b.Vm=a);this.Fa.setContent("Publishing...");QYc(this,b,!0)}};p.Eyb=function(){var a=this.cb.F();if(this.C.Qk)if(a&&a.isEmpty())OYc(this,1);else{var b=PYc(this);b.Vm=a;QYc(this,b)}else this.C.Vm=a,MYc(this)};function r_(a,b){return a.C.Qk&&(!b||!a.C.Vm||a.C.Vm.$Gb(b))}
function EYc(a){this.D=a;this.KJ=this.bt=this.Qk=!1;this.yw=!0;this.F=this.C=this.domain=""}EYc.prototype.tP=function(){return!!this.D};function FYc(){hV.call(this)}y(FYc,hV);FYc.prototype.Jj=function(a){return a.keyCode&&27==a.keyCode?!1:FYc.qa.Jj.call(this,a)};function VYc(a,b,c,d){this.F=a;this.uh=b;this.C=c;this.D=d}function WYc(a,b){return new VYc(!1,null,new XYc(a,b||"interactive"),null)}function XYc(a,b){this.id=a;this.format=b};function s_(a,b,c){this.F=a;this.D=new jk(b);this.C=c}p=s_.prototype;p.$Gb=function(a){return this.F||!a.F&&vb(a.D.od(),this.I8,this)&&vb(a.C,this.x8,this)};p.I8=function(a){return this.F||this.D.contains(a)};function YYc(a,b){return tb(a.C,function(a){return a.id==b.id})}p.x8=function(a){return this.F||this.D.contains(a.uh)||YYc(this,a)};function ZYc(a,b){a.C=qb(a.C,function(a){return a.uh!=b})}function $Yc(a,b){YYc(a,b)&&(a.C=qb(a.C,function(a){return a.id!=b.id}))}
function UYc(a,b){var c=a.F||b.F;if(c)return new s_(c,[],[]);var d=a.clone();A(b.D.od(),function(a){d.D.contains(a)||(d.D.add(a),ZYc(d,a))});A(b.C,function(a){d.x8(a)||d.C.push(a)});return d}function TYc(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.od().join(","),charts:rb(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&zb(this.C)};p.clone=function(){return new s_(this.F,this.D.od(),Jb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&Rb(this.C,a.C,function(a,c){return a.id==c.id&&a.uh==c.uh})};function aZc(a,b){this.id=a;this.uh=b};function bZc(a,b,c,d){R.call(this,void 0);this.C=c||new VYc(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new BM("",cZc(a,b));PR(this.D,!0);this.Qa(this.D,!0);a=new pv;a.Qa(new it("Interactive","interactive"),!0);a.Qa(new it("Image","image"),!0);this.H=new BM("",a);this.Qa(this.H,!0);a=new pv;a.Qa(new it("Web page","html"),!0);a.Qa(new it("Comma-separated values (.csv)","csv"),!0);a.Qa(new it("Tab-separated values (.tsv)","tsv"),!0);a.Qa(new it("PDF document (.pdf)","pdf"),!0);a.Qa(new it("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Qa(new it("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new BM("",a);this.Qa(this.F,!0);dZc(this)}y(bZc,p_);var eZc=["xlsx","ods"],fZc=["csv","tsv"];
function cZc(a,b){var c=new pv;c.Qa(new it("Entire Document",new gZc("entireDocument",null)),!0);c.Qa(new ov,!0);var d=a9a(b);A(a.D,function(a){c.Qa(new it(a.we(),new gZc("sheet",a.Jb())),!0);if(a=d[a.Jb()])for(var b=0;b<a.length;b++){var e=a[b];6==e.getType()&&e.isSaved()&&(e=new it(lXc(e),new gZc("chart",pH(e))),c.Qa(e,!0),Zr(e.Pb(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=bZc.prototype;
p.Ra=function(){bZc.qa.Ra.call(this);Zr(this.getElement(),"pub-dialog-link-options-container");Zr(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");Zr(this.D.Pb(),"pub-dialog-link-options-document-part-menu-button-content");Zr(this.D.wc().getElement(),"pub-dialog-link-options-document-part-menu");Wr(this.D.La,"Sheet or chart selection");Wr(this.H.La,"Chart format");Wr(this.F.La,"Sheet format");this.getHandler().V(this.D,"change",this.Job).V(this.H,"change",this.Alb).V(this.F,
"change",this.eBb).V(this.D,"afterhide",function(a){a.stopPropagation()}).V(this.H,"afterhide",function(a){a.stopPropagation()}).V(this.F,"afterhide",function(a){a.stopPropagation()})};p.Job=function(){var a=this.D.jf().hb();switch(a.type){case "entireDocument":this.C=new VYc(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!hZc(this,a,b)&&(b=null);this.C=new VYc(!1,a,null,b||"html");break;case "chart":this.C=WYc(a.id,this.C.C?this.C.C.format:null)}dZc(this);BYc(this)};
p.Alb=function(){var a=this.H.jf().hb();this.C.C&&(this.C.C.format=a,BYc(this))};p.eBb=function(){var a=this.F.jf().hb();this.C.D=a;BYc(this)};
function dZc(a){var b=Jb(a.D.Vj.C);b=wb(b,function(a){a=a.hb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.uh&&a.id==this.C.uh;case "chart":return!!this.C.C&&a.id==this.C.C.id;default:return!1}},a);Iv(a.D,b);b=!!a.C.C;Q(a.H.getElement(),b);a.C.C&&a.H.fb(a.C.C.format);Q(a.F.getElement(),a.J&&dwa&&!b);b||(iZc(a),a.F.fb(a.C.D))}function iZc(a){for(var b=a.F.wc(),c=0;c<b.mj();c++){var d=b.Te(c),e=d.$a();d.eb(null==a.C.uh||hZc(a,a.C.uh,e))}}
function hZc(a,b,c){return yb(eZc,c)?!1:(a=BC(a.O,b))&&1==a.getSheetType()&&yb(fZc,c)?!1:!0}p.RX=g("C");p.mK=function(){if(this.C.F)return new s_(!0,[],[]);if(null!=this.C.uh)return new s_(!1,[this.C.uh],[]);var a=this.L.C(this.C.C.id);a=new aZc(this.C.C.id,a.Jb());return new s_(!1,[],[a])};p.rpa=function(a){if(!a.F){var b=a.D.od();0<b.length?this.C=new VYc(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=WYc(a[0].id)));dZc(this)}};function gZc(a,b){this.type=a;this.id=b};function t_(a,b){sv.call(this,void 0,void 0,new AM,void 0);this.ib=a;this.Ia=b;this.F=new s_(!0,[],[]);this.va=!1;this.O=new PO("Entire Document");this.Fd(this.O);this.Fd(new ov);jZc(this);PR(this,!0);kZc(this)}y(t_,sv);function jZc(a){var b=a9a(a.Ia);A(a.ib.D,function(c){var d=new PO(c.we(),c);a.Fd(d);(c=b[c.Jb()])&&A(c,function(b){6==b.getType()&&b.isSaved()&&(b=new PO(lXc(b),b),a.Fd(b),Zr(b.Pb(),"pub-dialog-published-content-chart-menu-item"))})})}
t_.prototype.Ra=function(){t_.qa.Ra.call(this);Zr(this.getElement(),"pub-dialog-published-content-menu-button");Zr(this.Pb(),"pub-dialog-published-content-menu-button-content");Zr(this.wc().getElement(),"pub-dialog-published-content-menu");this.getHandler().V(this,"afterhide",function(a){a.stopPropagation()})};
t_.prototype.Ls=function(a){if(a.target==this.O){a=this.O.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.hb(),b instanceof NA?(b=b.Jb(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),ZYc(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),ZYc(a,b)))):(b=new aZc(pH(b),b.Jb()),a?(a=this.F,a.x8(b)||a.C.push(b)):$Yc(this.F,b));this.va=!0;kZc(this)};t_.prototype.xe=function(a,b){t_.qa.xe.call(this,a,b);!a&&this.va&&(this.va=!1,this.dispatchEvent(new I("oe")))};
function kZc(a){var b=a.F.F;a.O.yc(b);A(Bpc(a.wc()),function(c){var d=c.hb();d&&(d instanceof NA?(c.yc(a.F.I8(d.Jb())),c.eb(!b)):(d=new aZc(pH(d),d.Jb()),c.yc(a.F.x8(d)),c.eb(!a.F.I8(d.uh))))});lZc(a)}function lZc(a){if(a.F.F)var b="Entire Document";else{b=qb(a.ib.D,v(function(a){return this.F.I8(a.Jb())},a));b=rb(b,function(a){return a.we()});for(var c=[],d=a.F.C,e=0;e<d.length;e++){var f=a.Ia.C(d[e].id);f&&c.push(lXc(f))}b=Ib(b,c);b=0<b.length?b.join(", "):"None"}a.setContent(b)};function u_(a,b){R.call(this,void 0);this.C=new t_(a,b);this.Qa(this.C,!0);this.D=!1}y(u_,CYc);u_.prototype.Ra=function(){u_.qa.Ra.call(this);Zr(this.getElement(),"pub-dialog-published-content-container")};u_.prototype.F=function(){return this.C.F};u_.prototype.H=function(a){var b=this.C;b.F=a.clone();kZc(b)};u_.prototype.J=function(a){!a&&this.C.Yo()&&(this.D=!0);this.C.eb(a);a&&this.D&&(this.Wb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function mZc(a){a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+sXc(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return U(""+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function nZc(a,b,c,d,e,f,h){var k=null!=h?WYc(h):null;h=new bZc(c,d,k,!0);k=new bZc(c,d,k,!1);q_.call(this,a,b,e,Gva,f,h,k,new u_(c,d),"/publishingsettings",new oZc);this.Kf=c;this.tc=d}y(nZc,q_);
nZc.prototype.UFa=function(a){if(a.entireDocument)return new s_(!0,[],[]);var b=a.charts||"";a=rb((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=qb(a,function(a){return!!BC(this.Kf,a)},this);b=rb(b.split(","),function(a){return parseInt(a,10)});b=qb(b,v(function(a){return!!this.tc.C(a)},this));b=rb(b,function(a){var b=this.tc.C(a);return new aZc(a,b.Jb())},this);return new s_(!1,a,b)};nZc.prototype.AFa=function(){return new s_(!0,[],[])};
function KYc(a,b){if(b.F||null!=b.uh){var c="html"==b.D;a=NYc(a,c?"/pubhtml":"/pub");null!=b.uh&&(a=Ej(a,"gid",b.uh,"single","true"));c||(a=Ej(a,"output",b.D))}else a=Ej(NYc(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function LYc(a,b){var c=KYc(a,b);if(b.F||null!=b.uh)c=Ej(c,"widget","true","headers","false");a=b.C?(a=a.tc.C(b.C.id))?a.Xc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Xa(c)+'"></iframe>'}function oZc(){}y(oZc,R);oZc.prototype.Ha=function(){this.La=S(mZc,{locale:"en"})};function pZc(a,b,c){return RFa(a||"There was a problem",Fi(b),void 0,void 0,void 0,void 0,c)};function qZc(a){return U("<div><div>"+T(a.V4a)+"</div>"+T(St({id:"waffle-confirm-suppress-checkbox",xd:"waffle-confirm-suppress-checkbox"}))+'<span id="waffle-confirm-suppress-label">'+T(a.Oqa)+"</span></div>")};function rZc(a,b,c,d,e,f,h){if(Ca(c)){var k=new Bs;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=gFa;return sZc(d||"Heads up!",a,b,k,e,f,h)}function sZc(a,b,c,d,e,f,h){b=Fi(b);if(f){b=vt(qZc({V4a:b,Oqa:f}));var k=new Tt;var l=c;c=function(){l(k.isChecked())}}a=SFa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Qa(k),k.kb(oo(a.Aa(),"waffle-confirm-suppress-checkbox")),c=oo(a.Aa(),"waffle-confirm-suppress-label"),Bt(k,c),k.yc(!1));return a};function tZc(a){var b=a.description;a=a.FPb;return U('<div class="waffle-dv-rec-chip" title="'+W(b)+'"><div class="waffle-dv-rec-range">'+T(a)+'</div><div class="waffle-dv-rec-description">'+T(b)+"</div></div>")}function uZc(){return U('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function v_(){var a=new BM(null);PR(a,!0);return a};function vZc(a,b,c){J.call(this);this.D=a;this.uj=b;this.Ub=c;this.R=this.H=this.Pa=this.Ia=this.$=this.F=null;this.Zc=new vS;this.qf=new vS;this.Fa=this.O=null;this.Cd=new vS;this.xg=new vS;this.gb=this.bb=this.cb=this.va=this.L=null;this.Le=new vS;this.Pe=new vS;this.kd=new vS;this.vf=new vS;this.ib=this.tc=null;this.C=new WW("");this.jb=this.J=this.Kb=this.Db=this.Xd=this.Yb=this.Nb=this.Ab=null;this.kh=this.Lc=!1;this.ud=this.Kf=this.Lb=this.wb=null;this.ye=new Oi(this);this.Ba(this.ye);this.Nc=
new Yk;this.jh=this.Gi=this.Qh=this.Rg=this.oi=this.Wa=null;this.Nx();a=this.ye;a.V(this.F,"action",this.Ssb);a.V(this.$,"action",this.Xka);a.V(this.Ia,"action",this.Xka);a.V(this.Pa,"action",this.Xka);a.V(this.J,"focus",Fa(this.gSa,!0));a.V(this.J,"blur",Fa(this.gSa,!1));a.V(this.J,"change",this.Mka);a.V(this.J,"keyup",this.Mka);b=[this.O,this.Fa,this.H,this.R,this.L,this.va,this.bb,this.gb];for(c=0;c<b.length;c++)this.ye.V(b[c],"change",v(this.TWb,this,b[c])),this.ye.V(b[c],"keyup",v(this.Nsb,this,
b[c]));a.V(this.Lb,"change",v(this.BKa,this));a.V(this.cb,"change",v(this.gEb,this));a.Zg(this.jb,Je,this.Gzb)}y(vZc,J);var wZc="placeholder"in document.createElement("input"),xZc=/\s*,\s*/;function yZc(a){var b=a.jh;b||(b=[{gj:"List from a range",type:4},{gj:"List of items",type:3},{gj:"Number",type:0},{gj:"Text",type:1},{gj:"Date",type:2},{gj:"Custom formula is",type:5}],F(E(),"fecdv")&&b.push({gj:"Checkbox",type:6}),a.jh=b);return b}
function zZc(a){var b=a.Gi;b||(b=[{gj:"contains",code:9,inputs:0,example:"Approved"},{gj:"does not contain",code:10,inputs:0,example:"Approved"},{gj:"equals",code:13,inputs:0,example:"Approved"},{gj:"is valid email",code:14,inputs:-1,example:null},{gj:"is valid url",code:15,inputs:-1,example:null}],a.Gi=b);return b}
function AZc(a){var b=a.Rg;b||(b=[{gj:"is valid date",code:30,inputs:-1,example:null},{gj:"equal to",code:16,inputs:2,example:"11/15/2014"},{gj:"before",code:17,inputs:2,example:"11/15/2014"},{gj:"on or before",code:19,inputs:2,example:"11/15/2014"},{gj:"after",code:18,inputs:2,example:"11/15/2014"},{gj:"on or after",code:20,inputs:2,example:"11/15/2014"},{gj:"between",code:21,inputs:3,example:"11/15/2014",uP:"11/15/2015"},{gj:"not between",code:22,inputs:3,example:"11/15/2014",uP:"11/15/2015"}],
a.Rg=b);return b}function BZc(a){var b=a.Qh;b||(b=[{gj:"range",code:23,inputs:6,example:null},{gj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Qh=b);return b}
function CZc(a){var b=a.oi;b||(b=[{gj:"between",code:7,inputs:8,example:"10",uP:"100"},{gj:"not between",code:8,inputs:8,example:"10",uP:"100"},{gj:"less than",code:3,inputs:7,example:"10"},{gj:"less than or equal to",code:4,inputs:7,example:"10"},{gj:"greater than",code:1,inputs:7,example:"10"},{gj:"greater than or equal to",code:2,inputs:7,example:"10"},{gj:"equal to",code:5,inputs:7,example:"10"},{gj:"not equal to",code:6,inputs:7,example:"10"}],a.oi=b);return b}
function DZc(){return{gj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function EZc(){return{gj:"",code:31,inputs:-1,example:""}}p=vZc.prototype;
p.Nx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,q,t,w,x,z,C=a.Aa(),L;var O=C.Ha("TR","waffle-dv-trrules",C.Ha("TD","waffle-dv-label",C.Ha("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),C.Ha("TD",{colspan:"7"},l=C.Ha("DIV","goog-inline-block"),L=C.Ha("DIV","goog-inline-block"),h=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=C.Ha("SPAN","waffle-dv-separator","and"),k=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.kd.kb(h);this.vf.kb(k);this.Cd.kb(c);this.xg.kb(d);this.Zc.kb(e);this.qf.kb(f);var V=v_();zr(V,l);var ea=v_();zr(ea,l);var ca=v_();zr(ca,l);var qa=v_();zr(qa,l);var wa=FZc(a,L);(w=V.getElement())&&Sr(w,"labelledby","waffle-dv-criteria");
var ua;var ya=C.Ha("TR","waffle-dv-trrules waffle-dv-trrules-showitems",C.Ha("TD"),C.Ha("TD",{colspan:"7"},ua=C.Ha("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));w=new Tt;Bt(w,ua);zr(w,ua);var Ya=C.Ha("TR","waffle-dv-trrules waffle-dv-trrules-showitems",C.Ha("TD"),C.Ha("TD",{colspan:"7"},m=C.Ha("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Wa=new Tt;Bt(Wa,m);zr(Wa,m);var Va=C.Ha("TR","waffle-dv-trrules",C.Ha("TD"),C.Ha("TD","waffle-dv-customcheckboxlabel",
C.Ha("SPAN",{id:"customCheckboxInputLabel_checked"},"Checked:")),C.Ha("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},q=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var Ab=C.Ha("TR","waffle-dv-trrules",C.Ha("TD"),C.Ha("TD","waffle-dv-customcheckboxlabel",C.Ha("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unchecked:")),C.Ha("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},t=C.Ha("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.Le.kb(q);
this.Pe.kb(t);Sr(q,"labelledby","customCheckboxInputLabel_checked");Sr(t,"labelledby","customCheckboxInputLabel_unchecked");yS(this.Le,"e.g., TRUE");yS(this.Pe,"e.g., FALSE");var Rc=C.Ha("TR","waffle-dv-trrules",C.Ha("TD","waffle-dv-label",C.Ha("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),C.Ha("TD",{colspan:"7"},C.Ha("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},C.Ha("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),C.Ha("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),C.Ha("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),C.Ha("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new Yyc(!0);Zyc(m,"onInvalidData",Rc);var Wb=C.Ha("TR","waffle-dv-trrules waffle-dv-trrules-appearance",C.Ha("TD",null,C.Ha("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),C.Ha("TD",{colspan:"7"},x=C.Ha("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Yc=new Tt;Bt(Yc,x);zr(Yc,x);x=Yc.La;var Zc=uEa(x,"labelledby");Sr(x,"labelledby","waffle-dv-appearance "+Zc);x=C.Ha("TR","waffle-dv-trrules",C.Ha("TD"),C.Ha("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},z=C.Ha("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Zc=C.Ha("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));io(Zc,!0);a=a.O.childNodes[0];C.appendChild(a,O);C.appendChild(a,
ya);C.appendChild(a,Ya);C.appendChild(a,Va);C.appendChild(a,Ab);C.appendChild(a,Rc);C.appendChild(a,Wb);C.appendChild(a,x);this.C.render(l);C=this.C;C.ina=29;C.resize();C=this.C;C.uNa=200;C.resize();this.C.getElement().style.width="324px";wZc?this.C.getElement().placeholder="Enter items separated by a comma...":(C=this.C.getElement(),Nu(C,"Enter items separated by a comma...","Enter items separated by a comma..."));if(C=this.C.getElement())Wr(C,"Enter items separated by a comma..."),$r(C,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=z;V.setVisible(!0);C=yZc(this);GZc(this,C,V);C=CZc(this);GZc(this,C,qa);C=zZc(this);GZc(this,C,ea);C=AZc(this);GZc(this,C,ca);HZc(this,V,qa,ea,ca,h,k,c,d,e,f,b,l,wa,ya,x,w,ua,Zc,Yc,L,m,Wa,q,t,Ya,Va,Ab)};
function HZc(a,b,c,d,e,f,h,k,l,m,q,t,w,x,z,C,L,O,V,ea,ca,qa,wa,ua,ya,Ya,Wa,Va){a.F=b;a.F.setVisible(!0);a.Ia=c;a.$=e;a.Pa=d;a.tc=t;a.L=f;a.va=h;a.O=k;a.Fa=l;a.H=m;a.R=q;a.ib=w;a.Wa=x;a.Ab=ca;a.cb=wa;a.bb=ua;a.gb=ya;a.Xd=Ya;a.Db=Wa;a.Kb=Va;Q(a.Xd,!1);Q(a.Db,!1);Q(a.Kb,!1);ea.yc(!1);a.Lb=ea;a.ud=qa;IZc(a,!1);a.Nb=z;L.yc(!0);a.wb=L;a.Kf=O;a.Yb=C;Q(a.Yb,!0);JZc(a);KZc(a);a.jb=V;Q(a.jb,!1)}
function LZc(a,b){Q(a.Nb,23==b||24==b);a.Kf.innerText="Show dropdown list in cell";b=31==b;Q(a.Xd,b);var c=a.cb.isChecked();Q(a.Db,b&&c);Q(a.Kb,b&&c)}function MZc(a){HZc(a,a.F,a.Ia,a.Pa,a.$,a.L,a.va,a.O,a.Fa,a.H,a.R,a.tc,a.ib,a.Wa,a.Nb,a.Yb,a.wb,a.Kf,a.jb,a.Lb,a.Ab,a.ud,a.cb,a.bb,a.gb,a.Xd,a.Db,a.Kb)}function GZc(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.Aa();e=new it(b[d].gj,null,e);c.Fd(e);Rr(e.getElement(),"menuitem")}c.Bf(0)}p.Xka=function(){KZc(this);this.J.value=NZc(this);this.dispatchEvent("change")};
p.Ssb=function(){JZc(this);KZc(this);this.J.value=NZc(this);this.dispatchEvent("change")};p.gSa=da("kh");p.Mka=function(a){this.Lc||a&&!YCa(a)||this.J.value===OZc(this)||(this.Lc=!0,Q(this.jb,!0))};p.Gzb=function(){this.Lc=!1;this.J.value=NZc(this);Q(this.jb,!1)};p.BKa=function(){Q(this.Yb,this.Lb.isChecked())};p.gEb=function(){var a=this.cb.isChecked();a||PZc(this);Q(this.Db,a);Q(this.Kb,a);QZc(this)};function QZc(a){a.J.value=NZc(a)}function RZc(a){QZc(a);a.C.resize()}
p.TWb=function(a){QZc(this);SZc(this,a)?(this.D.Kl=0,w_(a),this.dispatchEvent("change")):(this.D.Kl=1,x_(a),this.dispatchEvent("error"))};p.Nsb=function(){this.dispatchEvent("keyup")};function SZc(a,b){if(0!=y_(a))return!0;var c=b.value;if(null!=c&&rr(b)){if(!TZc(a.D))return!0;a=z_(a,c,UZc(a).code);return!!a&&(Oe(a,3)||Oe(a,5)&&M(a,5).Qc()&&3==M(M(a,5).$a(),1))}return!0}function x_(a){a.select();Zr(a,"waffle-input-error")}function w_(a){a&&as(a,"waffle-input-error")}
function PZc(a){w_(a.C.getElement());w_(a.H);w_(a.R);w_(a.L);w_(a.va);w_(a.bb);w_(a.O);w_(a.Fa);w_(a.Wa.Lr());a.D.Kl=0;a.dispatchEvent("change")}function y_(a){return yZc(a)[a.F.dh()].type}function JZc(a){var b=y_(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.$.setVisible(c);a.Ia.setVisible(d);a.Pa.setVisible(e);Q(a.ib,f);Q(a.Ab,h);Q(a.L,!1);Q(a.va,!1);Q(a.O,!1);Q(a.Fa,!1);Q(a.H,!1);Q(a.R,!1);f&&a.C.resize();a.dispatchEvent("change")}
function UZc(a){var b;VZc(a)?b=VZc(a):a.$.isVisible()?b=AZc(a)[a.$.dh()]:a.Ia.isVisible()?b=CZc(a)[a.Ia.dh()]:5==y_(a)?b=DZc():6==y_(a)?b=EZc():b=zZc(a)[a.Pa.dh()];return b}function VZc(a){var b=BZc(a);return 4==y_(a)?b[0]:3==y_(a)?b[1]:null}
function KZc(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,q=UZc(a);-1!=q.inputs&&(0==q.inputs?d=!0:1==q.inputs?k=e=d=!0:2==q.inputs?f=!0:3==q.inputs?k=h=f=!0:7==q.inputs?b=!0:8==q.inputs?k=c=b=!0:5==q.inputs?l=!0:6==q.inputs&&(m=!0));var t=UZc(a);if(3==y_(a))wZc?a.C.getElement().placeholder="Enter items separated by a comma...":(t=a.C.getElement(),Nu(t,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(t.example)if(0==t.inputs||1==t.inputs)yS(a.Cd,"e.g., "+
t.example),yS(a.xg,"e.g., "+t.uP||"");else if(2==t.inputs||3==t.inputs)yS(a.Zc,"e.g., "+t.example),yS(a.qf,"e.g., "+t.uP||"");else if(7==t.inputs||8==t.inputs)yS(a.kd,"e.g., "+t.example),yS(a.vf,"e.g., "+t.uP||"");PZc(a);Q(a.L,b);Q(a.va,c);Q(a.O,d);Q(a.Fa,e);Q(a.H,f);Q(a.R,h);Q(a.ib,l);l&&a.C.resize();Q(a.Ab,m);LZc(a,q.code);Q(a.tc,k)}
function z_(a,b,c){var d=TZc(a.D);if(""==b||null==d.fd)return null;var e=d.rect,f=e.kc();e=e.gc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.fd+"",f,e,b,c,!0))?a.Nc.jd(Jf.Na(),b):null}
function WZc(a){var b=new Nf,c=UZc(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(z_(a,a.O.value,d));break;case 1:e.push(z_(a,a.O.value,d));e.push(z_(a,a.Fa.value,d));break;case 2:e.push(z_(a,a.H.value,d));break;case 3:e.push(z_(a,a.H.value,d));e.push(z_(a,a.R.value,d));break;case 7:e.push(z_(a,a.L.value,d));break;case 8:e.push(z_(a,a.L.value,d));e.push(z_(a,a.va.value,d));break;case 5:a=a.C.$a().split(",");for(c=0;c<a.length;c++)e.push(tXc(a[c]));break;case 6:c=OZa("="+a.Wa.$a());e.push(z_(a,c,
d));break;case -1:a.cb.isChecked()&&(e.push(z_(a,Sa(a.bb.value),d)),Qa(a.gb.value)||e.push(z_(a,Sa(a.gb.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=pS(d,e);N(b,1,d);return b}function XZc(a){var b=Sa(a.Wa.$a());!a.Ub.C.D[Sa(fb(b).toLowerCase())]&&yU(a.Ub,b)&&(b=$pc(a.Ub,b,!0));return b}function NZc(a){return a.Lc||a.kh?a.J.value:OZc(a)}
function OZc(a){var b="";var c=y_(a);var d=4==c;c=3==c||4==c;if(a.$.isVisible())c=AZc(a)[a.$.dh()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Pa.isVisible())c=zZc(a)[a.Pa.dh()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that ";else if(c)c=VZc(a),b+="Click and enter a value from ";else if(5==y_(a))c=DZc(),b="Enter a value that satisfies the formula:";else if(6==y_(a))if(c=EZc(),a.cb.isChecked()&&!Qa(Sa(a.bb.value))){b=Sa(a.bb.value);var e=
Sa(a.gb.value);b=Qa(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=CZc(a)[a.Ia.dh()],b+="Enter a number ";-1!=c.inputs&&(b+=c.gj);e=XZc(a);23==c.code&&""!=e&&d&&(d=$pc(a.Ub,e,!0))&&(b+=" "+d);Qa(fb(a.O.value))||0!=c.inputs&&1!=c.inputs?Qa(fb(a.H.value))||2!=c.inputs&&3!=c.inputs?Qa(fb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Qa(fb(a.Fa.value))||1!=c.inputs?Qa(fb(a.R.value))||3!=c.inputs?Qa(fb(a.va.value))||
8!=c.inputs||(b+=" and "+a.va.value):b+=" and "+a.R.value:b+=" and "+a.Fa.value;return b}function IZc(a,b){a.ud.Hl(b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function A_(a,b){switch(b){case 0:a.F.Bf(2);break;case 1:a.F.Bf(3);break;case 2:a.F.Bf(4);break;case 3:a.F.Bf(1);break;case 4:a.F.Bf(0);break;case 5:a.F.Bf(5);break;case 6:a.F.Bf(6)}}
function YZc(a,b,c,d,e){a.F.Bf(0);a.$.Bf(0);a.Ia.Bf(0);a.Pa.Bf(0);a.J.value="";a.L.value="";a.va.value="";a.H.value="";a.R.value="";a.O.value="";a.Fa.value="";a.C.fb("");a.Wa.fb("");IZc(a,!1);var f=a.Lc=!1,h=!1,k=!1,l=!1,m=!1,q=!1,t=!1,w=!1,x=!1,z=!1,C=!1,L=!1,O=!1,V=!1,ea=!1,ca=!1,qa=!1,wa=!1,ua=b&&M(b,1);b=ua&&Lf(ua);if((ua=ua&&Ue(ua,2))&&b){for(var ya=BZc(a),Ya=AZc(a),Wa=CZc(a),Va=zZc(a),Ab=DZc(),Rc=EZc(),Wb=0,Yc=0;Yc<ya.length;Yc++)if(b==ya[Yc].code){Wb=ya[Yc].inputs;23==ya[Yc].code?(ca=!0,A_(a,
4)):(L=!0,A_(a,3));a.wb.yc(!!e);break}for(e=0;e<Ya.length;e++)if(b==Ya[e].code){Wb=Ya[e].inputs;a.$.Bf(e);A_(a,2);O=w=!0;break}for(e=0;e<Wa.length;e++)if(b==Wa[e].code){Wb=Wa[e].inputs;a.Ia.Bf(e);A_(a,0);V=x=!0;break}for(e=0;e<Va.length;e++)if(b==Va[e].code){Wb=Va[e].inputs;a.Pa.Bf(e);A_(a,1);ea=z=!0;break}b==Ab.code&&(Wb=Ab.inputs,A_(a,5),qa=!0);b==Rc.code&&(Wb=Rc.inputs,A_(a,6),wa=!0);if(O||ea||V||L||ca||qa||wa)if(ea=TZc(a.D),O=ea.rect.kc(),V=ea.rect.gc(),ea=ea.fd+"",-1==Wb)wa&&0<ua.length&&(C=
!0,a.cb.yc(!0),a.Le.fb(bE(ua[0],ea,O,V)),1<ua.length&&a.Pe.fb(bE(ua[1],ea,O,V)));else if(0==Wb)m=bE(ua[0],ea,O,V),a.Cd.fb(m),m=!0;else if(1==Wb)q=bE(ua[0],ea,O,V),m=bE(ua[1],ea,O,V),a.Cd.fb(q),a.xg.fb(m),q=m=t=!0;else if(2==Wb)f=bE(ua[0],ea,O,V),a.Zc.fb(f),f=!0;else if(3==Wb)h=bE(ua[0],ea,O,V),f=bE(ua[1],ea,O,V),a.Zc.fb(h),a.qf.fb(f),h=f=t=!0;else if(7==Wb)k=bE(ua[0],ea,O,V),a.kd.fb(k),k=!0;else if(8==Wb)l=bE(ua[0],ea,O,V),k=bE(ua[1],ea,O,V),a.kd.fb(l),a.vf.fb(k),l=k=t=!0;else if(5==Wb){L=!0;wa=[];
for(Wb=0;Wb<ua.length;Wb++)wa.push(bE(ua[Wb],ea,O,V));a.C.fb(wa.join(","));a.C.resize()}else 6==Wb&&(ca=!0,wa=bE(ua[0],ea,O,V),null!=wa&&(wa=wa.substring(1),ua=!!wE(wa),wa=(Wb=yE(wa,a.uj,!1,!0))?AE(Wb.rect,Wb.Ug):wa,ua||(wa=xE(wa)),a.Wa.fb(wa)));else a.F.Bf(0),ca=!0;Q(a.tc,t);a.$.setVisible(w);a.Ia.setVisible(x);a.Pa.setVisible(z);Q(a.H,f);Q(a.R,h);Q(a.O,m);Q(a.Fa,q);Q(a.L,k);Q(a.va,l);Q(a.Db,C);Q(a.Kb,C);Q(a.Nb,!0);Q(a.ib,L);a.C.resize();Q(a.Ab,ca);null!=b&&LZc(a,b)}else{if(Xva){w=AI(a.uj);x=w.Ic();
z=new jk;for(C=x.kc();C<x.Mc();C++)for(L=x.gc();L<x.Pc();L++)ca=w.Uf(C,L),""!=LE(ca)&&z.addAll(LE(ca).split(xZc));z.isEmpty()?w=!1:(MZc(a),a.C.fb(z.od().join(",")),A_(a,3),JZc(a),w=!0)}else w=!1;w||MZc(a)}a.BKa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Za(Sa(c.substring(w+9))));a.Lb.yc(!!c);c&&(NZc(a)!=c&&a.Mka(),a.J.value=c,Q(a.Yb,!0));IZc(a,d)}
p.Oa=function(){this.gb=this.bb=this.va=this.L=this.Fa=this.O=this.R=this.H=null;H(this.C);this.Nb=this.wb=this.jb=this.J=this.tc=this.C=null;H(this.Wa);this.Wa=null;H(this.wb);this.wb=null;H(this.Pa);this.Pa=null;H(this.Ia);this.Ia=null;H(this.$);this.$=null;H(this.F);this.F=null;vZc.qa.Oa.call(this)};function ZZc(a,b,c,d,e,f,h){ss.call(this);this.Ab=a;this.Zc=b;this.tc=c;this.Lc=d;this.Ia=e;this.wb=f;this.Lb=h;this.R=new R(this.Aa());this.Qa(this.R);this.Kb=new Hu("",new tW,this.Aa());this.Qa(this.Kb);this.Db=new R(this.Aa());this.Qa(this.Db);this.cb=new jW(!1,"#4285f4");this.Qa(this.cb);this.Nb=new qW(c,$Zc.tca,$Zc.uca);this.Ba(this.Nb);this.F=this.O=null;this.jb=new Oi(this);this.Ba(this.jb);this.ib=this.L=this.J=this.C=null;this.gb=F(E(),"fedvs");this.Fa=null;this.Yb=[];this.Ub=-1;this.L=new Bs;
this.L.set("save","Save",!1);this.L.set("clear","Remove validation",!1,!1);this.L.set("cancel","Cancel",!1,!0);Es(this,this.L);As(this,!1);this.render();a=this.Pb();b=this.Aa();c=$Zc;ts(this,"Data validation");this.J||(d=b.Ha("DIV",{"class":c.CWa}),e=b.Ha("DIV",{"class":c.BWa},d),b.appendChild(a,e),this.J=new Yt(e),this.J.setType("warning"),this.J.setContent(""),this.J.render(d),mHa(this.J,!0),this.J.setVisible(!1));this.gb&&(e=b.Ha("DIV",c.g1a),f=b.Ha("DIV",{id:a_c.vxa},"Suggested validations"),
d=b.Ha("DIV",c.f1a),h=b.Ha("DIV",c.zYa,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Kb.kb(h),this.R.kb(d),e=b.Ha("DIV",c.U0a),b.appendChild(d,e),this.Db.kb(e),this.cb.render(e),kW(this.cb,!0));this.O=b.Ha("TABLE",{cellSpacing:"0","class":c.xI},b.Ha("TBODY"));b.appendChild(a,this.O);this.gb&&Zr(this.O,c.o1a);a=this.Pb();a=tn(a);b=a.Ha("TR",$Zc.E1a);b.appendChild(a.Ha("TD","waffle-dv-label",a.Ha("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));
c=a.Ha("TD",{colspan:"7"});this.C=FZc(this,c);b_c(this);b.appendChild(c);a.appendChild(this.O.childNodes[0],b);(a=this.C.Lr())&&Sr(a,"labelledby","waffle-dv-cell-range");this.F=new vZc(this,this.Ab,this.Ia);qt(this,"save");c_c(this)}y(ZZc,ss);
var $Zc={BWa:"waffle-input-error-butter-container",CWa:"waffle-input-error-butter-wrap",zYa:"waffle-dv-feedback-link",tca:"waffle-dv-highlight-styled-border",uca:"waffle-dv-highlight-styled-rect",Iua:"waffle-input-error",U0a:"waffle-dv-rec-spinner-container",nda:"waffle-dv-rec-chip-selected",f1a:"waffle-dv-rec-wrapper",g1a:"waffle-dv-recs-title-bar",xI:"waffle-dv-table",o1a:"waffle-dv-table-with-suggestions",E1a:"waffle-dv-trrules"},a_c={vxa:"waffle-dv-recs-title"};p=ZZc.prototype;p.Kl=0;
function b_c(a){if(a.C){var b=a.Ab.getActiveGrid();b&&(b=AE(VF(a.tc).Ic(),b.we()),a.C.fb(b))}}function c_c(a){a.jb.V(a,"dialogselect",a.SWb).V(a.F,"error",a.Lsb).V(a.F,"change",a.RWb);a.gb&&a.jb.V(a.wb,"recommender-calc-ended",a.QWb).V(a.Kb,"action",function(){P.Su.mc({source:"dataValidationDialogFeedback"})})}p.Lsb=function(){d_c(this)};p.RWb=function(){d_c(this);Hs(this.L,"save",!0)};function e_c(a){var b=a.Aa();a=a.R.La;var c=S(uZc);b.appendChild(a,c)}
p.QWb=function(a){var b=this;kW(this.cb,!1);Q(this.Db.La,!1);a=a.C;if(0==a.length)e_c(this);else{var c=this.Aa(),d=this.R.La,e=0;A(a,function(a){var f=M(a,13);if(!(3<=e)&&f){e++;var k=wU(a),l=AE(fl(k)),m=M(f,3);b.Yb.push(m);a="";switch(Lf(m)){case 14:a="Is valid email";break;case 15:a="Is valid URL";break;case 30:a="Is valid date";break;case 24:a=Ue(m,2).map(function(a){return M(M(a,5).$a(),2)}).join();break;case 1:a="Greater than "+M(M(Ue(m,2)[0],5).$a(),3);break;case 7:a=Ue(m,2);a="Between "+(M(M(a[0],
5).$a(),3)+(" and "+M(M(a[1],5).$a(),3)));break;default:Bac.C("Unrecognized data validation type.")}a=S(tZc,{description:a,FPb:l});var q=new Yu("",c);q.wf(8,!0);q.kb(a);Sr(a,"describedby",a_c.vxa);b.R.Qa(q);c.appendChild(d,a);b.jb.V(q,"action",function(){f_c(b,q,m,l)}).V(a,"mouseenter",function(){rW(b.Nb,rU(k))}).V(a,"mouseleave",function(){sW(b.Nb)})}})}};
function f_c(a,b,c,d){var e=$Zc,f=Yr(b.La,e.nda);a.R.Ef(function(a){a.Ik(e.nda,!1);a.Fc(!1)});b.Ik(e.nda,!f);b.Fc(!f);f?(a.show(!0),a.Fa=null):(b=new Nf,N(b,1,c),YZc(a.F,b,null,null,!0),RZc(a.F),a.C.fb(d),a.Fa=c)}p.SWb=function(a){if("save"==a.key){if(!g_c(this)){a.preventDefault();return}}else{var b;if(b="clear"==a.key)(b=h_c(this))?(this.Lb.Xb(35300),b=this.Lc.C(new pT(new Of,b))):b=!1,b=!b;if(b){a.preventDefault();return}}this.C&&this.C.eb(!1)};
function d_c(a){var b=i_c(a.Kl);b&&a.J.setContent(b);a.J.setVisible(0!=a.Kl);b=2==a.Kl||4==a.Kl;var c=$Zc,d=a.Aa().Yw(a.C.getElement());cs(d,c.Iua,b);b&&a.C.Lr().select()}
function i_c(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid checked value.";case 9:return"Enter different values for checked and unchecked cell contents.";case 10:return"Formulas are not permitted as custom checked/unchecked values."}return null}
function j_c(a){var b=a.F,c=y_(b);if(0==c){c=b.L;var d=b.va,e=SZc(b,c),f=SZc(b,d);e&&f?b.D.Kl=0:(e||x_(c),f||x_(d),b.D.Kl=1)}else if(1==c)c=b.O,d=b.Fa,e=!rr(c)||!Qa(fb(c.value)),f=!rr(d)||!Qa(fb(d.value)),e&&f?b.D.Kl=0:(e||x_(c),f||x_(d),b.D.Kl=6);else if(2==c)c=b.H,d=b.R,e=!rr(c)||!Qa(fb(c.value)),f=!rr(d)||!Qa(fb(d.value)),e&&f?b.D.Kl=0:(e||x_(c),f||x_(d),b.D.Kl=7);else if(3==c||4==c)c=0,4==y_(b)?(d=XZc(b),yU(b.Ub,d)?(d=XZc(b),d=zU(b.Ub,d),e=TZc(b.D),d&&e&&d.fd==e.fd&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==y_(b)&&b.C.getElement()&&Qa(fb(b.C.$a()))&&(c=5),d=c,c=0==d,b.D.Kl=d,d=b.Ab&&rr(b.Ab),b.ib&&rr(b.ib)?(cs(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.Aa().Yw(b.Wa.getElement()),cs(d,"waffle-input-error",!c),b.Wa.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.cb.isChecked()){c=b.bb;e=b.gb;d=Sa(fb(c.value));e=Sa(fb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==e.toLowerCase();
var h=mb(d)==mb(e);f=d==e||h||f;Qa(d)?(x_(c),b.D.Kl=8):f?b.D.Kl=9:px(d)||px(e)?b.D.Kl=10:b.D.Kl=0}}else b.D.Kl=0;b=a.C.$a();b=yU(a.Ia,b);2==a.Kl&&b?a.Kl=0:0!=a.Kl||b||(a.Kl=2);d_c(a);return 0!=a.Kl}
function g_c(a){if(j_c(a))return!1;var b=a.F,c=b.ud.isChecked("rejectInvalidData_radio"),d=NZc(b);b.Lb.isChecked()||(d="");var e=WZc(b);if(!e)return!1;var f=new Of;N(f,1,e);N(f,2,d);N(f,3,c);npc(f,rr(b.Nb)&&b.wb.isChecked());b=h_c(a);if(!b)return!1;c=new Vp;e=M(e,1);d=a.Fa&&Lf(a.Fa)==Lf(e);var h=Ue(e,2);if(d){var k=Ue(a.Fa,2);k=k.length==h.length&&k.every(function(a,b){return a.equals(h[b])});D(c,12,!k);Apc(c,Uvc(Lf(e)))}k=ja(a.Yb);for(var l=k.next();!l.done;l=k.next())kXc(c,Uvc(Lf(l.value)));k=Ha()-
a.Ub;D(c,14,1E3*k);k=new Tp;cd(k,58,c);c=Gq(Hq(new Fq,k),1).build();a.Lb.Xb(d?35578:35301,c);31==Lf(e)&&a.Lb.Xb(0<h.length?35604:35603,c);return a.Lc.C(new pT(f,b))}function h_c(a){var b=a.C.$a();b=(b=zU(a.Ia,b))?b.rect:null;var c=a.C.$a();a=(a=zU(a.Ia,c))?a.fd:null;return b&&null!=a?dl(b,a):null}function TZc(a){var b=a.C.$a();return zU(a.Ia,b)}
function FZc(a,b){var c=a.Ab.C.we();c=new kV(a.tc,v(a.PWb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.Aa());a.getHandler().V(c,"change",function(){var a=this.F;a&&QZc(a)});c.render(b);return c}p.setVisible=function(a){ZZc.qa.setVisible.call(this,a);a&&this.ib&&(this.ib.focus(),this.ib=null)};p.PWb=function(a,b,c,d){this.ib=a.Lr();this.Zc.yba(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=AI(this.Ab),e=BF(d);e=PE(vF(d,e));d=null;var f=!1;e&&(e=e.C,d=M(e,1),b=M(e,2),c=M(e,3),f=M(e,4));YZc(this.F,d,b,c,f);this.setVisible(!0);this.C&&this.C.eb(!0);b_c(this);RZc(this.F);this.gb&&!a&&(epc(this.wb)?(Ipc(this.wb),Spc(this.wb,!0,!1,[6])):(kW(this.cb,!1),Q(this.Db.La,!1),e_c(this)));this.Ub=Ha()};p.Oa=function(){H(this.F);this.F=null;H(this.C);this.L=this.O=this.C=null;ZZc.qa.Oa.call(this)};function k_c(a,b,c,d,e){ss.call(this);this.Lc=d.O;this.ib=c;this.wb=d.C;this.cb=d;this.Yb=e;this.jb=null;this.Lb=d.R;ts(this,"Find and replace");As(this,!1);c=this.Pb();d=tn(c);this.C=d.Ha("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Ia=d.Ha("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new BM(null);this.Zc=b;this.O=new kV(this.ib,v(this.wXb,this),!1,"",!0);this.R=null;this.Fa=new Tt;this.gb=new Tt;this.L=new Tt;this.J=new Tt;this.Ub=this.Db=this.Kb=
this.Nb=!1;this.Ab=d.Ha("SPAN");Arc(this.Ab);this.tc=new rt(this.C);this.Ba(this.tc);a=l_c;d.Ha("LABEL",{"for":a.pua},"Search");b=d.Ha("LABEL",{"for":a.nva},"Match case");e=d.Ha("LABEL",{"for":a.ova},"Match entire cell contents");var f=d.Ha("LABEL",{},"Also search within formulas"),h=d.Ha("LABEL",{"for":a.Swa},"Search using regular expressions "),k=(new Pj(Hva)).toString(),l=d.Ha("SPAN",null,d.Ha("A",{target:"_blank",href:k},"Help"));this.getHandler().V(l,["keydown","keypress"],function(a){13==a.keyCode&&
a.stopPropagation()});k=Ar(this,"findLabel");var m=Ar(this,"replaceLabel"),q=Ar(this,"findScopeLabel"),t=d.Ha("DIV","goog-inline-block"),w=d.Ha("DIV",a.u0a);l=d.Ha("TABLE",null,d.Ha("TBODY",null,d.Ha("TR",null,d.Ha("TD",a.LABEL,d.Ha("LABEL",{id:k},"Find")),d.Ha("TD",null,this.C)),d.Ha("TR",null,d.Ha("TD",a.LABEL,d.Ha("LABEL",{id:m},"Replace with")),d.Ha("TD",null,this.Ia)),d.Ha("TR",null,d.Ha("TD",null,d.Ha("LABEL",{id:q},"Search")),d.Ha("TD",null,t,w)),d.Ha("TR",null,d.Ha("TD",null,""),d.Ha("TD",
null,b,d.Ha("BR"),e,d.Ha("BR"),h,l,d.Ha("BR"),f)),d.Ha("TR",null,d.Ha("TD",{colspan:"2"},this.Ab))));this.F.render(t);Zr(this.F.getElement(),a.pua);this.O.render(w);zr(this.Fa,b);Bt(this.Fa,b);this.Fa.getElement().id=a.nva;zr(this.gb,e);Bt(this.gb,e);this.gb.getElement().id=a.ova;zr(this.L,h);Bt(this.L,h);this.L.getElement().id=a.Swa;Bt(this.J,f);zr(this.J,f);Sr(this.C,"labelledby",k);Sr(this.Ia,"labelledby",m);Sr(this.F.La,"labelledby",q);d.appendChild(c,l);c=new Bs;c.set("findNext","Find",!0);c.set("replace",
"Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Es(this,c);qt(this,"");this.getHandler().V(this,"dialogselect",this.xXb).V(this.tc,"input",this.Wla).V(this.L,"change",this.rAb).V(this.F,"change",this.Lqb).V(this.O,"change",this.yXb).V(this.J,"change",this.sAb);c=new st;c.kb(this.C);this.Ba(c);c=new st;c.kb(this.Ia);this.Ba(c);m_c(this);c=new fs(this.getElement());this.Ba(c);this.getHandler().V(c,"focusin",this.hVa).V(this.getElement(),"mousedown",this.hVa)}y(k_c,ss);
var l_c={Xsa:"waffle-find-replace-dialog-border",pua:"waffle-find-replace-find-scope-select",Iua:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",nva:"find-replace-case",ova:"find-replace-cell",Swa:"find-replace-regex",u0a:"waffle-find-replace-selection-input goog-inline-block"};
function m_c(a){var b=VF(a.ib),c=null,d=null;b&&(c=pub(b),d=BC(a.wb,c.fd).we());a.J.yc(a.Lb);var e=new it("All sheets",hSa.aWa),f=new it("This sheet",hSa.C0a),h=new it("Specific range",hSa.rI);a.F.Fd(e);a.F.Fd(f);a.F.Fd(h);f=c?$G(a.wb,c.fd):null;f=(f=c&&f?aF(f,c.rect.kc(),c.rect.gc()):null)?f.yh():1;c&&c.rect.yh()>f?Iv(a.F,h):Iv(a.F,e);b&&a.O.fb(AE(c.rect,d))}function n_c(a){var b=a.F.jf().hb(),c=$F(a.ib.C);return 0==b?yE(a.O.$a(),a.wb,!1,!0):1!=b||null===c?null:new Vk(c,"",new Ek(0,0,1,1))}p=k_c.prototype;
p.hVa=function(a){a.target==this.getElement()?this.focus():this.Yb.Mb(2)};p.yXb=function(){o_c(this)};p.sAb=function(){var a=this.J.isChecked();G6b(this.cb,a)};p.Lqb=function(){o_c(this)};p.rAb=function(){this.L.isChecked()&&this.Fa.yc(!0);this.Wla()};
p.xXb=function(a){var b=p_c;if("findNext"==a.key)a.preventDefault(),this.Nb&&(B_(this,null),q_c(this,b.oua));else if("replace"==a.key)a.preventDefault(),this.Kb&&(B_(this,null),q_c(this,b.ewa));else if("replaceAll"==a.key&&(a.preventDefault(),this.Ub)){a=v(function(){B_(this,null);q_c(this,b.dwa)},this);var c=this.F.jf().hb();1<this.wb.D.length&&2==c&&!this.Db?(bpc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Db=!0):a()}};
p.Wla=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;Fs(this.D,"findNext").disabled=!a;this.Nb=a;r_c(this,a);this.Kb&&!a&&s_c(this,!1);cs(this.C,"waffle-input-error",b)};p.wXb=function(a,b,c){this.jb=a.Lr();this.Zc.yba(this,a,b,c,!1,!0)};
function o_c(a){var b=0==a.F.jf().hb();a.O.setVisible(b);H(a.R);a.R=null;var c=n_c(a),d=VF(a.ib);b&&d&&c&&(a.R=QM(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.R.setVisible(!0),a.Ba(a.R))}function q_c(a,b){if(0!=a.F.jf().hb()||n_c(a)){var c=a.F.jf().hb();a.dispatchEvent(new t_c(b,a.C.value,a.Ia.value,c,a.Fa.isChecked(),a.gb.isChecked(),a.L.isChecked(),a.J.isChecked(),n_c(a)))}else cs(a.O.D,"waffle-range-selection-error",!0),B_(a,"Invalid range")}
p.setVisible=function(a){var b=this.cb.vd();r_c(this,!b);s_c(this,!b);this.Ia.disabled=b;k_c.qa.setVisible.call(this,a);a&&this.jb&&(this.jb.focus(),this.jb=null)};p.aSb=function(a){this.C.value=a};p.CRa=function(){this.C.select()};p.focus=function(){this.Wb()&&this.isVisible()&&(this.C.focus(),this.Yb.Mb(2),Uw(this.C,this.C.value.length),this.Wla())};function s_c(a,b,c){b=b&&!a.cb.vd()&&0==!a.C.value.length;a.Kb=b;a=Fs(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function r_c(a,b){var c=!!wb(G5a(a.Lc),function(a){return!a.Pj()});b=b&&!a.cb.vd()&&!c&&0==!a.C.value.length;a.Ub=b;a=Fs(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}function B_(a,b){var c=tn(a.Pb());a=a.Ab;b?(0<Zn(a).length&&c.appendChild(a,c.Ha("BR")),c.appendChild(a,c.Ha("B",null,so(c,b)))):c.Dd(a)}p.Oa=function(){k_c.qa.Oa.call(this);this.Db=!1;G6b(this.cb,this.Lb)};
function t_c(a,b,c,d,e,f,h,k,l){I.call(this,a);this.F=b;this.J=c;this.C=d;this.L=e;this.O=f;this.$=h;this.Pa=k;this.Wa=l||null}y(t_c,I);var p_c={oua:"findnext",jcc:"findall",ewa:"replace",dwa:"replaceall",DONE:"done",F4b:"canceled"};function u_c(a,b,c,d,e){G.call(this);var f=p_c;this.H=null;this.C=a;this.D=b;this.F=c;this.O=d;this.L=e;this.J=new Oi(this);this.Ba(this.J);this.J.V(a,f.dwa,this.zzb).V(a,f.ewa,this.Azb).V(a,f.oua,this.gVa).V(a,f.DONE,this.Pob)}y(u_c,G);var C_={xN:"cg",yN:"cr",wN:"cc",nua:"loop"};p=u_c.prototype;p.cUb=function(){this.C.setVisible(!0);v_c(this,null)};p.gVa=function(a){if(WF(this.D.C)){var b=VF(this.D).hb(),c=this.H;c||(c=BF(b),c=tc(C_.xN,b.fc(),C_.yN,PF(b,c.y),C_.wN,QF(b,c.x)));w_c(this,a,b,c)}};
function w_c(a,b,c,d){var e=new Yk,f=x_c(b);y_c(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.jd((new YA).Na(),a);a=M(f,1);var d=b.type;WF(this.D.C)&&(c?Oe(c,1)?(d=M(c,1),c=tc(C_.xN,parseInt(d.Jb(),10),C_.yN,d.qz(),C_.wN,d.getColumnIndex(),C_.nua,M(c,2)),z_c(this,a,c)):(z_c(this,a,{}),"replace"==d&&this.C.focus()):A_c(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function y_c(a,b,c){if(c){var d=""+c[C_.xN],e=new Qf;N(e,1,d);N(e,2,MF(b,c[C_.yN],"r"));N(e,3,MF(b,c[C_.wN],"c"));N(a,10,e)}}
function x_c(a){var b=new WA;N(b,1,a.F);N(b,3,a.J);N(b,5,a.C);if(0==a.C||1==a.C){var c=a.Wa,d=new zf;N(d,1,""+c.fd);var e=c.rect.kc();N(d,2,e);Af(d,c.rect.Mc());Bf(d,c.rect.gc());Cf(d,c.rect.Pc());b.setSelection(d)}N(b,6,a.L||!1);N(b,7,a.O||!1);N(b,8,a.$||!1);b.setType(a.Pa?1:0);N(b,11,0);return b}function z_c(a,b,c){c?c&&null!=c.cg?(b=c[C_.xN],c[C_.nua]&&B_(a.C,"No more results found, looping around"),a.F.AA(b,v(a.vXb,a,c))):(v_c(a,null),B_(a.C,"There are no entries matching "+b)):A_c(a)}
p.vXb=function(a){var b=VF(this.D).hb(),c=a[C_.yN],d=a[C_.wN];a[C_.yN]=PF(b,c);a[C_.wN]=QF(b,d);v_c(this,a);a=new rk(d,c);b=new Vk(b.fc(),"",Gk(a));AU(this.F,b,v(this.I2a,this,a))};
p.I2a=function(a){if(!this.isDisposed()){this.C.focus();var b=VF(this.D).hb();ME(b.Uf(a.y,a.x))&&!this.C.J.isChecked()&&s_c(this.C,!1,"Can't replace formula");var c=cF(b,a.y),d=dF(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=zE(a),a=LE(vF(b,a)),B_(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function A_c(a){B_(a.C,null);B_(a.C,"Error while searching spreadsheet. Please try again.")}
p.Azb=function(a){if(!this.L.vd()){var b=this.H;if(b){var c=DE(this.F,b[C_.xN]);if(c){c=c.Kc();var d=MF(c,b[C_.yN],"r"),e=MF(c,b[C_.wN],"c"),f=c.Uf(d,e);if(!ME(f)||this.C.J.isChecked()){f=LE(f);var h=new Yk,k=x_c(a);N(k,5,0);y_c(k,c,b);var l=new zf;N(l,1,""+b[C_.xN]);N(l,2,d);Af(l,d+1);Bf(l,e);Cf(l,e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);B_c(this,c,k,f,b,!1);this.gVa(a)}}}}};
p.zzb=function(a){if(!this.L.vd()&&WF(this.D.C)){var b=this.F.getActiveGrid().Kc(),c=x_c(a);B_c(this,b,c,a.F,a.J,!0)}};
function B_c(a,b,c,d,e,f){b=new YW(b,c);KA(b,v(function(a,b){a?(a=M(b,5),b=M(b,4),b=0==a?"No matches found":f?(new np(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),B_(this.C,null),B_(this.C,b)):A_c(this)},a));B_(a.C,null);B_(a.C,"Working...");a.O.C(b)||A_c(a)}p.Pob=function(){v_c(this,null)};function v_c(a,b){a.H=b;(a=a.C)&&s_c(a,!!b)};function D_(a,b){ss.call(this,"docs-material-dialog",a,b);Es(this,null);Ds(this,!0);zs(this,this.LJ?0:.6);this.O=new wW("Ok");this.Qa(this.O);this.R=new Zvc("Cancel");this.Qa(this.R)}r(D_,ss);D_.prototype.Ra=function(){var a=this;ss.prototype.Ra.call(this);this.getHandler().V(this.O,"action",function(){return a.L()}).V(this.R,"action",function(){a.dispatchEvent("qe")&&a.setVisible(!1)})};D_.prototype.L=function(){this.dispatchEvent("pe")&&this.setVisible(!1)};
D_.prototype.Ha=function(){ss.prototype.Ha.call(this);var a=xs(this);this.R.render(a);this.O.render(a);Q(a,!0);xt(bFa(this),awc)};D_.prototype.Cz=function(a){ss.prototype.Cz.call(this,a);zs(this,this.LJ?0:.6)};function C_c(a,b,c,d){D_.call(this);ts(this,"Grouping rule");this.gb=a;this.cb=b;this.Ia=c;this.Fa=d;this.F=new yW;this.F.setContent("Starting at");this.Qa(this.F,!0);this.J=new yW;this.J.setContent("Create group by");this.Qa(this.J,!0);this.C=new yW;this.C.setContent("Ending at");this.Qa(this.C,!0)}r(C_c,D_);
C_c.prototype.L=function(){var a=this.gb.C.C;if(a&&0==a.getSheetType()){var b=UF(a.Kc());var c=new xg;if(""!=this.F.$a()){var d=parseFloat(this.F.$a());N(c,1,d)}""!=this.J.$a()&&(d=parseFloat(this.J.$a()),N(c,2,d));""!=this.C.$a()&&(d=parseFloat(this.C.$a()),N(c,3,d));d=new ug;d.setType(2);N(d,3,c);c=this.Ia?b.Ak:b.Dm;for(var e=0;e<c.length;e++)if(M(c[e],1)==this.Fa){N(c[e],10,d);this.cb.C(new Vvc(b,a.Jb()));break}D_.prototype.L.call(this)}};function D_c(a){a=""+(""+E_c({id:"waffle-resize-selection-custom",HMa:a.jga,$k:Jt("<br/>"+T(AXc({id:"waffle-resize-input",xd:"waffle-resize-inset-input"})))})+E_c({id:"waffle-resize-selection-auto",HMa:It("Fit to data"),$k:Jt("")})+"");return U(a)}function E_c(a){return U('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+W(a.id)+'"><label for="'+W(a.id)+'" class="waffle-resize-label">'+T(a.HMa)+"</label>"+T(a.$k)+"</div>")}
function F_c(a){var b=a.Ycb;a='<label for="waffle-resize-input">'+T(a.jga)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return U(a+"")};function G_c(a,b,c,d,e){ss.call(this);this.L=a;this.Ia=b;var f=this.L.Ic().dd();this.C=f;this.F=qb(this.L.Gj(),function(a){return a.dd()==f});this.J=new vS;this.O=new Yyc(!0);this.R=new Tt;this.cb=c;this.gb=d;this.Fa=e}y(G_c,ss);var H_c={AUTO:"waffle-resize-selection-auto",xt:"waffle-resize-selection-custom",vca:"waffle-resize-input",p_a:"waffle-resize-selection",o0a:"waffle-resize-rows-can-grow-checkbox"};p=G_c.prototype;
p.Ha=function(){G_c.qa.Ha.call(this);var a=this.F[0];if("r"==this.C){var b=a.kc();a=a.Mc()-1;var c=String(rE(b+1)),d=String(rE(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.gc(),a=a.Pc()-1,c=tE(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+tE(a)));ts(this,b);"r"==this.C?this.Pb().appendChild(S(F_c,{jga:I_c(this),Ycb:F(E(),"fefrha")})):this.Pb().appendChild(S(D_c,{jga:I_c(this)}));qt(this,
"ok")};p.Ra=function(){G_c.qa.Ra.call(this);var a=this.Aa(),b="r"==this.C;this.J.kb(a.getElement(H_c.vca));F(E(),"fefrha")&&b&&(a=a.getElement(H_c.o0a),Bt(this.R,a),zr(this.R,a));a=this.L.Ic();var c=a.dd();a=J0a(tF(this.L,c,Nk(a,c)));this.J.fb(String(a));b||(Zyc(this.O,H_c.p_a),this.O.Hl(H_c.xt));this.getHandler().V(this,"dialogselect",this.QYb).V(this.J.getElement(),"focus",this.jEb)};p.jEb=function(){"c"==this.C&&this.O.Hl(H_c.xt)};p.focus=function(){this.Wb()&&zS(this.J)};
function I_c(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(oF+")"):"Enter new column width in pixels. (Default: "+(K0a+")")}
p.QYb=function(a){if("ok"==a.key)if((a="r"==this.C)||$yc(this.O)==H_c.xt){var b=parseInt(this.J.$a(),10);isNaN(b)?FA("Entered value is not a number."):2>b||2E3<b?FA("Size must be between 2 and 2000 pixels."):(this.Fa.C("r"==this.C?35310:35308),b=new vP(this.L,this.F[0],b,this.F.slice(1)),F(E(),"fefrha")&&a&&(a=!this.R.isChecked(),b.L=a),this.Ia.C(b))}else b=VF(this.cb).Fa,a=b.F,b=F(E(),"fecllr")?b.C:null,this.Fa.C(35307),cEb(this.F,a,b,this.gb,this.Ia)};function J_c(a){Uc(this,a,0,-1,null,null)}y(J_c,Tc);J_c.prototype.getType=function(){return B(this,3)};J_c.prototype.setType=function(a){D(this,3,a)};function K_c(a){R.call(this,a);this.$=Lo("email");this.C=this.D=null}y(K_c,R);p=K_c.prototype;
p.Ha=function(){var a=this.Aa();var b=this.Aa();this.C=new OV;this.Ba(this.C);this.D=new OV;this.Ba(this.D);var c=b.Ha("DIV","waffle-dialog-notifications-input");Rr(c,"presentation");this.F=new MV;NV(this.F,b.Ha("LABEL",null,"Any changes are made"));this.F.render(c);this.C.QG(this.F);var d=b.Ha("DIV","waffle-dialog-notifications-input");Rr(d,"presentation");this.J=new MV;NV(this.J,b.Ha("LABEL",null,"A user submits a form"));this.J.render(d);this.C.QG(this.J);var e=b.Ha("DIV","waffle-dialog-notifications-input");
Rr(e,"presentation");this.H=new MV;NV(this.H,b.Ha("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.QG(this.H);var f=b.Ha("DIV","waffle-dialog-notifications-input");Rr(f,"presentation");this.L=new MV;NV(this.L,b.Ha("LABEL",null,"Email - right away"));this.L.render(f);this.D.QG(this.L);b=b.Ha("DIV",null,b.Ha("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.$+" when...")),b.Ha("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.$+" when...")},c,d),b.Ha("DIV",{style:"padding: 5px"}),
b.Ha("DIV","waffle-dialog-notifications-label","Notify me with..."),b.Ha("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.Aa();d=c.Ha("DIV");this.O=hS("Save",c);this.Qa(this.O,!1);this.O.render(d);this.R=new Yu("Cancel",c);this.Qa(this.R,!1);this.R.render(d);this.La=a.Ha("DIV","waffle-dialog-notifications",a.Ha("DIV",null,b),a.Ha("DIV",null,d))};
p.Ra=function(){K_c.qa.Ra.call(this);this.getHandler().V(this.O,"action",this.jRb,!0).V(this.R,"action",v(this.dispatchEvent,this,new I("cancelRuleEdit"))).V(this.C,"change",this.Hra).V(this.D,"change",this.Hra)};p.Bd=function(a){K_c.qa.Bd.call(this,a);a?1==a.getType()?this.C.Hl(this.F):2==a.getType()&&this.C.Hl(this.J):this.C.Hl(null);a?2==B(a,2)?this.D.Hl(this.H):1==B(a,2)&&this.D.Hl(this.L):this.D.Hl(null);this.Hra()};p.focus=function(){var a=PV(this.C),b=this.C.Xj.Te(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};p.jRb=function(){this.dispatchEvent(new I("saveRule",L_c(this)))};function L_c(a){var b=new J_c,c=a.hb();c&&(c=B(c,1),D(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?D(b,2,1):a.H.isChecked()&&D(b,2,2);return b}p.Hra=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.eb(a)};function E_(a,b){R.call(this,b);this.Bd(a)}y(E_,R);
E_.prototype.Ha=function(){var a=this.hb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==B(a,2)?c+="send digest email":1==B(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.Aa();a=d.Ha("TD",null);b=d.Ha("TD",{width:"50px"});c=d.Ha("TR",{valign:"center"},d.Ha("TD",null,d.Ha("SPAN","waffle-notification-rule",c)),d.Ha("TD",{align:"right"},d.Ha("TABLE",null,d.Ha("TBODY",null,d.Ha("TR",null,a,b)))));d=Os(Fu,"waffle-notifications-add");this.D=new Hu("Edit",
d,this.Aa());this.D.ef("goog-link-button");this.D.ef("menuMainLink");this.Qa(this.D,!1);this.D.render(a);this.C=new Hu("Delete",d,this.Aa());this.C.ef("goog-link-button");this.C.ef("menuMainLink");this.Qa(this.C,!1);this.C.render(b);this.La=c};E_.prototype.Ra=function(){E_.qa.Ra.call(this);this.getHandler().V(this.D,"action",this.H);this.getHandler().V(this.C,"action",this.F)};E_.prototype.H=function(){this.dispatchEvent(new I("edit",this.hb()))};
E_.prototype.F=function(){var a=v(function(){this.dispatchEvent(new I("del",this.hb()))},this),b=v(function(){this.C.getElement().focus()},this);rZc("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function M_c(a){R.call(this,a);this.C=null}y(M_c,R);M_c.prototype.Ha=function(){var a=this.Aa();this.C=a.Ha("TBODY");this.La=a.Ha("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};M_c.prototype.Pb=g("C");M_c.prototype.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};function N_c(a,b,c){ss.call(this);this.Fa=a;this.L=b;ts(this,"Set notification rules");As(this,!1);a=new Bs;a.set("cancel","Done",!1,!0);Es(this,a);this.C=new K_c(c);this.Qa(this.C,!1);this.F=new M_c;this.Qa(this.F,!1);this.J=new Hu("Add another notification rule",QO.getInstance(),this.Aa());this.Qa(this.J,!1)}y(N_c,ss);p=N_c.prototype;
p.Ha=function(){N_c.qa.Ha.call(this);var a=this.Aa(),b=J9a(this.Fa,new Pj(Dva+"91588")).toString();b=a.Ha("A",{target:"_blank",href:b},"Help");var c=a.Ha("DIV");this.J.render(c);this.R=a.Ha("DIV");this.O=a.Ha("DIV");var d=a.Ha("DIV","waffle-dialog-notifications-bounds",this.R,this.O);b=a.Ha("DIV",null,a.Ha("DIV",{align:"right"},b),d,c);a.appendChild(this.Pb(),b);qt(this,"")};
p.Ra=function(){N_c.qa.Ra.call(this);this.F.render(this.R);this.C.render(this.O);this.getHandler().V(this,"edit",this.ZYb).V(this,"del",this.YYb).V(this.J,"action",this.XYb).V(this,"saveRule",this.iRb).V(this,"cancelRuleEdit",this.e4a)};p.h_=function(a){this.isDisposed()||(this.C.setVisible(!1),O_c(this,!1),om(this.L,"/notifications/list",v(this.nVb,this,a)).ze())};
p.nVb=function(a,b,c){if(!this.isDisposed()){b=c.Ye();c=[];for(var d=0;d<b.length;d++)c[d]=new J_c(b[d]);this.Bd(c);if(a&&0==c.length)P_c(this,null,!1);else{if(a=this.hb())if(b=this.F,b.Dd(!0),b.Aa().Dd(b.Pb()),b.Bd(a),c=b.Aa(),0==a.length)c.appendChild(b.Pb(),c.Ha("TR",null,c.Ha("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Qa(new E_(a[d],c),!0);O_c(this,!0);this.focus()}}};
p.iRb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();B(a,1)?rm(om(this.L,"/notifications/set",v(this.h_,this,!1)),{rule:b}).ze():rm(om(this.L,"/notifications/create",v(this.h_,this,!1)),{rule:b}).ze()};p.e4a=function(){this.C.setVisible(!1);this.h_(!1)};p.ZYb=function(a){P_c(this,a?a.target:null,!0)};p.XYb=function(){P_c(this,null,!0)};function P_c(a,b,c){O_c(a,!1);var d=a.C;d.Bd(b);d.setVisible(!0);c&&a.C.focus()}
p.YYb=function(a){this.F.setVisible(!1);a=a.target;rm(om(this.L,"/notifications/delete",v(this.h_,this,!1)),{rule_id:B(a,1)}).ze()};function O_c(a,b){a.F.setVisible(b);var c=xs(a);Q(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.h_(!0)};function Q_c(a){var b="",c='Display language: <a id="ds-settings-link" target="_blank">'+(T(a.i6a)+"</a>");b+='<tr class="dialog-settings-general-settings-div"><div><span>'+c+"</span></div>";a.bTb&&(b+='<div class="dialog-settings-english-name-div">'+T(St({id:"waffle-settings-dialog-english-name-checkbox"}))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');return U(b+"</tr>")}
function R_c(){return U('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function F_(a,b,c,d){ss.call(this);this.Nb=a;this.Zc=b;this.L=c;this.tc=d;this.C={};this.Kb=this.wb=!1;this.Yb=this.Lb=this.Db="";this.Lc=new Yk;this.J=[];this.F=this.Lc.jd((new Jh).Na(),ritz_api.RitzModelApi.getWorkbookProperties());ts(this,"Settings for this spreadsheet");this.jb=!1;this.gb=new Tt;this.Qa(this.gb);this.R=new TU;this.Qa(this.R);this.O=new TU;this.Qa(this.O);this.Ab=new hV;this.Qa(this.Ab);this.cb=this.ib=null;this.Ub=new kp(1);this.Fa=this.Ia="";this.C[0]=v_();this.C[1]=v_();this.C[2]=
v_();this.C[3]=v_();this.C[4]=new vS;this.C[5]=new vS}y(F_,ss);var S_c=null,T_c={a2:0,v1a:1,mWa:2,sZa:3,GZa:4,lXa:5},U_c={U1a:"waffle-settings-dialog-english-name-checkbox",V1a:"waffle-settings-dialog-english-name-checkbox-label"},V_c=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],W_c=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=F_.prototype;
p.Ha=function(){F_.qa.Ha.call(this);var a=this.Pb(),b=this.Aa(),c=[X_c(b,"Locale","waffle-settings-label-locale"),Y_c(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),Z_c(this),X_c(b,"Time zone","waffle-settings-label-timezone"),Y_c(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
Z_c(this)],d=[];d.push(X_c(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(Y_c(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(Z_c(this));d.push(X_c(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=J9a(this.L,new Pj(Dva+"58515")).toString();e=b.Ha("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(Y_c(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=X_c(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=Y_c(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");$_c(e);d.push(e);this.J.push(e);e=X_c(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=Y_c(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");$_c(e);d.push(e);this.J.push(e);"OFF"==this.C[3].jf().$a()&&a0c(this);d.push(Z_c(this));c=Ib(c,d);c.push(S(Q_c,{i6a:this.Lb,bTb:this.jb}));this.ib=b.Ha("TABLE","dialog-settings",b.Ha("TBODY",null,c));this.cb=b.Ha("table","dialog-settings",b.Ha("tbody",null,d));c=S(R_c);b.appendChild(a,c);this.Ab.kb(c);b.appendChild(a,
this.ib);b.appendChild(a,this.cb);Q(this.cb,!1);S_c||(a=new Bs(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),S_c=a);Es(this,S_c);b0c(this,4,Oe(this.F,3)&&M(this.F,3).Z7()?M(this.F,3).R5().toString():"50");b0c(this,5,Oe(this.F,3)&&M(this.F,3).W7()?M(this.F,3).y5().toString():"0.05");qt(this,"save")};function $_c(a){a=a.firstChild.firstChild;Zr(a,"jfk-textinput");Xq(a,"width","7em")}function a0c(a){for(var b=0;b<a.J.length;b++)Q(a.J[b],!1)}
function X_c(a,b,c){return a.Ha("TR",null,a.Ha("TD",{id:c,"class":"dialog-settings-label"},b))}function Y_c(a,b,c,d,e,f,h){b=b.Ha("TR",null,b.Ha("TD","dialog-settings-input"),b.Ha("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.La;Sr(a,"labelledby",e);Sr(a,"describedby",f);return b}function Z_c(a){a=a.Aa();return a.Ha("TR",null,a.Ha("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Ha("HR",{"class":"dialog-settings-sep"})))}
p.Ra=function(){F_.qa.Ra.call(this);Fe(this,"dialogselect",v(this.oZb,this));this.getHandler().V(this.C[3],"action",this.rTb);this.getHandler().V(this.Ab,"select",this.OCb);var a=this.C[4].getElement();this.R.Cj(a);WU(this.R,a,a);this.R.render();VU(this.R);this.getHandler().V(a,"change",v(this.JVb,this));a=this.C[5].getElement();this.O.Cj(a);WU(this.O,a);this.O.render();VU(this.O);this.getHandler().V(a,"change",v(this.IVb,this));if(this.jb){a=this.Aa().getElement(U_c.U1a);var b=this.Aa().getElement(U_c.V1a);
this.gb.kb(a);Bt(this.gb,b);this.gb.yc(!fwa||F9a(this.L.F))}};p.setVisible=function(a){if(a){if(!this.wb){c0c(this);return}var b=this.L.L;b0c(this,0,b.C);b=b.D||yJb().name();b0c(this,1,b);b0c(this,2,Oe(this.F,3)&&M(this.F,3).mla()?M(this.F,3).bia().toString():"");b0c(this,3,Oe(this.F,3)&&Oe(M(this.F,3),1)?M(M(this.F,3),1)?"ON":"OFF":"OFF")}F_.qa.setVisible.call(this,a);if(this.wb&&!this.Kb){if(a=wn("ds-settings-link"))a.href=this.Db;this.Kb=!0}};
function c0c(a){qm(a.Zc.Oe("/info/settings").Df(d0c()),v(function(a){a=a.Ye();(a={locale:a.l?this.YJ(a.l):null,QTa:a.tz?this.YJ(a.tz):null,q6a:a.dls,RHb:a.dln,GVb:a.hl},a.locale)&&a.QTa&&(e0c(this,0,a.locale),e0c(this,1,a.QTa),e0c(this,2,V_c),e0c(this,3,W_c),this.Db=a.q6a,this.Lb=a.RHb,this.Yb=a.GVb,this.jb=fwa&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Yb),this.wb=!0);this.setVisible(!0)},a)).ze()}
function d0c(){var a=Yj(Lo("win").location.href),b=Xj(a,"hl");a=Xj(a,"forcehl");return["hl",b,"forcehl",a]}function e0c(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new it(e.caption,e.value);a.Fd(e);Rr(e.getElement(),"menuitem")}a.wc().getElement().style.overflow="auto";PR(a,!0)}p.YJ=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function b0c(a,b,c){(a=a.C[b])&&a.fb(c)}
p.oZb=function(a){if("save"==a.key)if("ON"!=this.C[3].jf().$a()||""==this.Ia&&""==this.Fa){f0c(this);a=this.L.L.C;this.Nb.C(g0c(this));this.Nb.C(h0c(this));if(this.jb){var b=!fwa||F9a(this.L.F);var c=this.gb.isChecked();b!=c?(N9a(this.L,c),b=Gq(new Fq,1).build(),this.tc.Xb(c?2433:2434,b),c=!0):c=!1}else c=!1;c||(c=this.C[0].jf(),c=null!=c&&c.$a()!=a);c&&Ssa(this.L.D.C,this.nZb)}else a.preventDefault(),f0c(this),""!=this.Ia&&UU(this.R,this.Ia,!0),""!=this.Fa&&UU(this.O,this.Fa,!0)};
p.rTb=function(a){if("ON"==a.target.$a())for(a=0;a<this.J.length;a++)Q(this.J[a],!0);else a0c(this);f0c(this)};function f0c(a){VU(a.R);VU(a.O)}p.JVb=function(){this.Ia="";var a=this.C[4].$a()||"";a=this.Ub.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ia="Please enter an integer value.";else if(0>=a||1E4<a)this.Ia="Please enter a value between 1 and 10000."};p.IVb=function(){this.Fa="";var a=this.C[5].$a()||"";a=this.Ub.parse(a);isNaN(a)?this.Fa="Please enter a numeric value.":0>a&&(this.Fa="Please enter a non-negative value.")};
p.OCb=function(a){switch(a.target.getId()){case "general-settings-tab":Q(this.ib,!0);Q(this.cb,!1);break;case "calculation-settings-tab":Q(this.ib,!1),Q(this.cb,!0)}};function g0c(a){var b=a.C,c=b[T_c.mWa].jf().$a(),d=b[T_c.sZa].jf().$a();a=b[T_c.GZa].$a()||"";b=b[T_c.lXa].$a()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new dQ(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function h0c(a){var b=a.C;a=a.L.L;var c=b[T_c.a2].jf();c=null==c?a.C:c.$a();b=b[T_c.v1a].jf();b=null==b?a.D||yJb().name():b.$a();return new SIb(c,b)}p.nZb=function(){(new gKb).exec()};p.Oa=function(){Zb(this.C,H);delete this.C;F_.qa.Oa.call(this)};function i0c(a,b,c,d,e,f,h){ss.call(this,void 0,!1,h);this.L=this.J=this.R=this.O=null;this.Ia=a;this.C=b;this.F=[];this.Fa=new Cec(a,d,e,f)}r(i0c,ss);p=i0c.prototype;
p.Ha=function(){ss.prototype.Ha.call(this);var a=this.Aa(),b=this.C.Ic(),c=zE(b.Re()),d=zE(new rk(b.left+b.width-1,b.top+b.height-1));ts(this,"Sort range from "+(c+(" to "+d)));j0c||(c=new Bs,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),j0c=c);Es(this,j0c);qt(this,"save");var e;c=a.Ha("DIV",{style:"overflow: hidden"},d=a.Ha("SPAN","jfk-checkbox"),e=a.Ha("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.L=new Tt(void 0,a);f.kb(d);Bt(f,e);1==b.height&&f.eb(!1);LI(this.Ia,this.C.fc(),
b)||(f.yc(!0),f.eb(!1));Jwa&&ritz_api.TablesApi.getTables((new Yk).serialize(dl(b,this.C.fc())),v(function(a){if(0<a.length){var c=a[0];a=D7b(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c))c=bl(a),c=1==vf(c)-M(c,1);c&&(c=dl(b,this.C.fc()),c=a.Jb()==c.Jb()&&pXc(bl(a),bl(c))&&pXc(cl(a),cl(c)));c&&f.yc(!0)}},this));d=this.Pb();a.appendChild(d,c);this.O=a.Ha("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Ha("TABLE",{cellSpacing:"0"},this.R=
a.Ha("TBODY")));a.appendChild(d,this.O);c=k0c(this);this.F.push(c);c=a.Ha("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);io(c,!0);Rr(c,"button");this.J=c};p.Ra=function(){ss.prototype.Ra.call(this);this.getHandler().V(this,"dialogselect",this.NIb).Zg(this.J,Je,this.ijb).V(this.L,"change",this.Nrb)};
function k0c(a){var b=a.Aa(),c=0==a.F.length,d=new l0c(a,c,a.C,0,b),e=b.Ha("TR",null,b.Ha("TD",{colspan:"4"},b.Ha("DIV","waffle-sd-row-separator")));d.render(a.R);b.appendChild(a.R,e);c||a.getHandler().Zg(d.D,Je,v(a.M5a,a,d));a=m0c(a);n0c(d,a);return d}p.M5a=function(a){var b=this.F;if(1<b.length){var c=ob(b,a);-1!=c&&(Hb(b,c),b=a.getElement(),b=ao(b),a.dispose(),Xn(b),Q(this.J,!0),this.J.focus(),GA("Sort criteria removed."))}};
function m0c(a){var b=a.C.Ic(),c=b.gc();b=b.Pc();var d=rb(a.F,function(a){return a.bk()},a);if(d)for(var e=OF(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=QF(a.C,f);if(!yb(d,h))return h}return null}p.Nrb=function(){for(var a=this.F,b=0;b<a.length;b++)n0c(a[b])};p.ijb=function(){var a=Sk(this.C.Ic(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(k0c(this)),GA("Sort criteria added."));ir(nb(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&Q(this.J,!1)};
p.NIb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.bk());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Ic();d=Sk(c,"r");if(this.L.isChecked()&&1<d){d=c.kc()+1;e=c.gc();var f=c.Mc(),h=c.Pc();c.top=d;c.left=e;c.height=f-d;c.width=h-e}a=new wec(a,b,this.C,c,this.L.isChecked());Dec(this.Fa,this.C,a)}};p.Oa=function(){ss.prototype.Oa.call(this);we(this.F)};var j0c=null;
function l0c(a,b,c,d,e){R.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.R=-1;this.$=a;this.O=b;this.H=c}r(l0c,R);l0c.prototype.bk=function(){var a=this.C.jf();return a?a.$a():-1};
l0c.prototype.Ha=function(){var a=this.Aa(),b=this.O?"sort by":"then by",c,d,e,f=a.Ha("TR","waffle-sd-tr-rules",a.Ha("TD","waffle-sd-delete",this.O?"":this.D=a.Ha("SPAN",{title:"Remove sort criteria."},"x")),a.Ha("TD","waffle-sd-td-rules",a.Ha("LABEL",{id:Ar(this,"csl")},b)),b=a.Ha("TD","waffle-sd-column-selector"),a.Ha("TD","waffle-sd-td-ascending",e=a.Ha("DIV",null,c=a.Ha("DIV",{title:"Ascending"}),d=a.Ha("DIV",{title:"Descending"}))));Rr(e,"radiogroup");e=this.F=new MV(a,to(a,Po(rx(!0,this.Af()))),
"ascending");e.render(c);a=this.L=new MV(a,to(a,Po(rx(!1,this.Af()))),"descending");a.render(d);this.J=new OV([e,a]);this.J.Hl(e);a=this.C=v_();a.render(b);Sr(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(io(this.D,!0),Rr(this.D,"button"),Wr(this.D,"Remove sort criteria."));this.La=f};
function n0c(a,b){var c=a.Aa(),d=a.$.L.isChecked(),e=a.H.Ic(),f=e.kc(),h=e.gc();e=e.Pc();a.R=b||a.bk();for(b=a.C.mj();0<b;b--)a.C.cC(0);for(;h<e;h++)b=ab(LE(a.H.Uf(f,h)),25),b=new it(Qa(b)||!d?"Column "+tE(h):b,QF(a.H,h),c),b.ef("waffle-sd-menu-item"),a.C.Fd(b);a.C.Bf(0);0<=a.R&&a.C.fb(a.R)}l0c.prototype.Oa=function(){R.prototype.Oa.call(this);this.C=this.D=this.H=this.$=null;H(this.F);H(this.L);H(this.J);this.J=this.L=this.F=null};function o0c(a){return U('<input type="text" id="docs-copy-link" class="'+W("docs-copy-link")+'" value="'+W(a.link)+'" readonly="readonly">')};function G_(a,b,c,d){Vt.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ia="";this.F=b||null;this.Fa=c||new kAb(a);this.R=null!=d?d:null;a=new Bs;Gs(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.Fa.C()&&Gs(a,{key:"copy-link",caption:"Copy Link"});Es(this,a)}y(G_,Vt);p=G_.prototype;
p.Ha=function(){G_.qa.Ha.call(this);Zr(ys(this),"copy-link-dialog");Zr(Fs(this.D,"done"),"copy-link-done-button");this.C=S(o0c,{link:this.Ia},void 0,this.Aa());Sr(this.C,"label","Link to this comment");this.Pb().appendChild(this.C);if(this.L=Fs(this.D,"copy-link")){var a=En("DIV");Zr(a,"copy-link-butter-holder");this.getElement().insertBefore(a,ws(this));this.O=new Zt(a);this.J=au("Link copied to clipboard.","info",!1,4E3)}null!==this.R&&(Xq(this.nx(),"z-index",this.R),Xq(ys(this),"z-index",this.R+
1))};p.Um=function(){G_.qa.Um.call(this);this.F&&this.getHandler().V(this.F,"copy",this.BCa);this.C.focus();this.C.select()};p.bp=function(){G_.qa.bp.call(this);this.F&&this.getHandler().Gc(this.F,"copy",this.BCa)};p.Ra=function(){G_.qa.Ra.call(this);this.getHandler().V(this.C,"click",this.CRb);this.L&&this.getHandler().V(this.L,"click",this.bnb)};p.hSb=function(a){this.Ia=a;this.C&&(this.C.value=a)};p.CRb=function(a){a.target.focus();a.target.select()};
p.bnb=function(a){a.stopPropagation();this.F&&this.Fa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.BCa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Oa=function(){G_.qa.Oa.call(this);H(this.J);delete this.J;delete this.L;delete this.C};function p0c(){G.call(this)}y(p0c,Ro);p=p0c.prototype;p.eeb=function(){return pZc};p.xeb=function(){return rZc};p.VJb=function(a,b,c,d){var e=new st;a=new pt(a,b,c,d,void 0,!0,void 0);qt(a,"ok");b=v(e.kb,e);a.Ula=b;a.Ba(e);a.pj=!0;a.T6=Fka(Qa);return a};p.egb=function(){return G_c};p.x5a=function(a,b,c,d,e){return new i0c(a,b,0,c,d,e,void 0)};p.Geb=function(){return ZZc};p.pFa=function(){return k_c};p.Veb=function(){return u_c};p.jgb=function(){return F_};p.igb=function(){return nZc};p.Qfb=function(){return C_c};
p.hgb=function(){return N_c};p.Beb=function(){return OXc};p.fgb=function(){return LXc};p.ggb=function(){return lYc};p.Aeb=function(){return G_};ap("dialogs",p0c);
